 % use the "wcp" class option for workshop and conference
 % proceedings
 %\documentclass[gray]{jmlr} % test grayscale version
 %\documentclass[tablecaption=bottom]{jmlr}% journal article
 \documentclass[pmlr,twocolumn,10pt]{jmlr} % W&CP article

% \usepackage{geometry}
% \geometry{margins=0.1in,textwidth=7in}

 % The following packages will be automatically loaded:
 % amsmath, amssymb, natbib, graphicx, url, algorithm2e

 %\usepackage{rotating}% for sideways figures and tables
 %\usepackage{longtable}% for long tables

 % The booktabs package is used by this sample document
 % (it provides \toprule, \midrule and \bottomrule).
 % Remove the next line if you don't require it.

\usepackage{booktabs}
 % The siunitx package is used by this sample document
 % to align numbers in a column by their decimal point.
 % Remove the next line if you don't require it.
\usepackage{siunitx}

% The lineno package is required for denoting line
% numbers for paper review.
\usepackage[switch]{lineno}

% ADDED packages
\usepackage{float}
\usepackage{caption}
\usepackage{enumitem}       % modify indent in enumerate

\usepackage{multirow}

%\usepackage[table]{xcolor}% http://ctan.org/pkg/xcolor
\usepackage{xcolor,colortbl}
\usepackage{color, colortbl} % https://texblog.org/2011/04/19/highlight-table-rowscolumns-with-color/ 
\usepackage{nicematrix}

\usepackage{xcolor} % Ensure this package is included

\usepackage[most]{tcolorbox} % loads skins, breakable, etc.
\usepackage{enumitem}

% In the preamble (if not already present)
% Optional: smaller captions overall and for subfigures
\usepackage{subcaption}



\raggedbottom

\newcommand{\Sref}[1]{\S\ref{#1}}

\definecolor{highlight}{rgb}{1.0,0.90,0.8}	
\definecolor{Gray}{gray}{0.96}

\definecolor{lightBlue}{rgb}{0.78, 0.85, 1.0}% Rule colour
\definecolor{lightOrange}{rgb}{0.88, 0.95, 1.0}% Rule colour
\definecolor{lightRed}{rgb}{1.0, 0.85, 0.85}% Rule colour
\usepackage{tcolorbox}% http://ctan.org/pkg/tcolorbox
\usepackage{multirow}
%\usepackage{tabularx,array}
\usepackage{array}

% in the preamble
\newcommand{\parahead}[1]{\medskip\noindent\textbf{#1}\par\smallskip}


\newtcbox{\bluebox}{on line, box align=base, colback=lightBlue,colframe=white,size=fbox,arc=3pt, before upper=\strut, top=-2pt, bottom=-4pt, left=-2pt, right=-2pt, boxrule=0pt}

\newtcbox{\orangebox}{on line, box align=base, colback=lightOrange,colframe=white,size=fbox,arc=3pt, before upper=\strut, top=-2pt, bottom=-4pt, left=-2pt, right=-2pt, boxrule=0pt}

\newtcbox{\redbox}{on line, box align=base, colback=lightRed,colframe=white,size=fbox,arc=3pt, before upper=\strut, top=-2pt, bottom=-4pt, left=-2pt, right=-2pt, boxrule=0pt}

\newtcbox{\whitebox}{on line, box align=base, colback=white,colframe=white,size=fbox,arc=3pt, before upper=\strut, top=-2pt, bottom=-4pt, left=-2pt, right=-2pt, boxrule=0pt}


\newcommand{\dashifted}{\raisebox{0.5\depth}{\tiny$\downarrow$}}
\newcommand{\upshifted}{\raisebox{0.5\depth}{\tiny$\uparrow$}}

% DOWN arrows Blue & Red
\newcommand{\dab}[1]{{\scriptsize\bluebox{\dashifted{#1}}}}
\newcommand{\dao}[1]{{\scriptsize\orangebox{\dashifted{#1}}}}
\newcommand{\dar}[1]{{\scriptsize\redbox{\dashifted{#1}}}}

% UP arrows Blue & Red
\newcommand{\uab}[1]{{\scriptsize\bluebox{\upshifted{#1}}}}
\newcommand{\uao}[1]{{\scriptsize\orangebox{\upshifted{#1}}}}
\newcommand{\uaw}[1]{{\scriptsize\whitebox{\upshifted{#1}}}}
\newcommand{\uar}[1]{{\scriptsize\redbox{\upshifted{#1}}}}


 % The following command is just for this sample document:
\newcommand{\cs}[1]{\texttt{\char`\\#1}}% remove this in your real article

% The following is to recognise equal contribution for authorship
\newcommand{\equal}[1]{{\hypersetup{linkcolor=black}\thanks{#1}}}

 % Define an unnumbered theorem just for this sample document for
 % illustrative purposes:
\theorembodyfont{\upshape}
\theoremheaderfont{\scshape}
\theorempostheader{:}
\theoremsep{\newline}
\newtheorem*{note}{Note}


\newcommand{\rafal}[1]{\textcolor{red}{\bf\small [#1 --Rafal]}}
\newcommand{\firdavs}[1]{\textcolor{magenta}{\bf\small [#1 --Firdavs]}}

% Replace XXX below with the specific PMLR volume number sent to you before the camera-ready submission
\jmlrvolume{XXX}
\jmlryear{2025}
\jmlrworkshop{Machine Learning for Health (ML4H) 2025} % W&CP title

 % The optional argument of \title is used in the header
 \title[Automated Natural Language Surgical Feedback Generation]{Generating Natural-Language Surgical Feedback: \\From Structured Representation to Domain-Grounded Evaluation}

 % Other Ideas: https://chatgpt.com/c/689e6012-d2f8-832f-ba21-5a461982f7fa
 

 % Anything in the title that should appear in the main title but 
 % not in the article's header or the volume's table of
 % contents should be placed inside \titletag{}

 %\title{Title of the Article\titletag{\thanks{Some footnote}}}


 % Use \Name{Author Name} to specify the name.
 % If the surname contains spaces, enclose the surname
 % in braces, e.g. \Name{John {Smith Jones}} similarly
 % if the name has a "von" part, e.g \Name{Jane {de Winter}}.
 % If the first letter in the forenames is a diacritic
 % enclose the diacritic in braces, e.g. \Name{{\'E}louise Smith}

 % \thanks must come after \Name{...} not inside the argument for
 % example \Name{John Smith}\nametag{\thanks{A note}} NOT \Name{John
 % Smith\thanks{A note}}

 % Anything in the name that should appear in the title but not in the 
 % article's header or footer or in the volume's
 % table of contents should be placed inside \nametag{}

 % Two authors with the same address
 % \author{%
 %  \Name{Author Name1\nametag{\thanks{A note}}} \Email{abc@sample.com}\and
 %  \Name{Author Name2} \Email{xyz@sample.com}\\
 %  \addr Address
 % }

 % Three or more authors with the same address:
 % \author{%
 %  \Name{Author Name1} \Email{an1@sample.com}\\
 %  \Name{Author Name2} \Email{an2@sample.com}\\
 %  \Name{Author Name3} \Email{an3@sample.com}\\
 %  \Name{Author Name4} \Email{an4@sample.com}\\
 %  \Name{Author Name5} \Email{an5@sample.com}\\
 %  \Name{Author Name6} \Email{an6@sample.com}\\
 %  \Name{Author Name7} \Email{an7@sample.com}\\
 %  \Name{Author Name8} \Email{an8@sample.com}\\
 %  \Name{Author Name9} \Email{an9@sample.com}\\
 %  \Name{Author Name10} \Email{an10@sample.com}\\
 %  \Name{Author Name11} \Email{an11@sample.com}\\
 %  \Name{Author Name12} \Email{an12@sample.com}\\
 %  \Name{Author Name13} \Email{an13@sample.com}\\
 %  \Name{Author Name14} \Email{an14@sample.com}\\
 %  \addr Address
 % }

 % Authors with different addresses and equal first authors:
% \author{%
% \Name{First Author 1}\equal{These authors contributed equally} \Email{abc@sample.com}\\
% \addr University X, Country 1
% \AND
% % footnotemark[1] is to refer to the \equal footnote
% \Name{First Author 2}\footnotemark[1] \Email{def@sample.com}\\
% \addr University Y, Country 2
% \AND
% \Name{Last Author} \Email{ghi@sample.com}\\
% \addr University Z, Country 3
% }

% \author{%
%   \Name{Anonymous Authors}\\
%   \addr Anonymized for review
% }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%% Remove the \linenumbers in the final version %%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\linenumbers % Activate line numbering

\begin{document}

\maketitle

\begin{abstract}
High-quality intraoperative feedback from a surgical trainer is pivotal for improving trainee performance and long-term skill acquisition. Automating natural, trainer-style feedback promises timely, accessible, and consistent guidance at scale—but requires models that understand 
clinically relevant representations. We present a structure-aware pipeline that learns a surgical action ontology from real trainer$\rightarrow$trainee transcripts (33 surgeries) and uses it to condition feedback generation. We contribute by 1) mining Instrument-Action-Target (IAT) triplets from real-world feedback text and clustering surface forms into normalized categories, 2) fine-tuning a video$\rightarrow$IAT model that leverages the surgical procedure and task contexts, as well as fine-grained temporal instrument motion (crucial for representing instruments and actions over time), and 3) demonstrating how to effectively leverage IAT triplet representation to guide GPT-4o in generating clinically-grounded natural, trainer-style feedback. We show that, on \textit{Task 1: Video$\rightarrow$IAT recognition}, our context injection and temporal tracking deliver consistent AUC gains -- Instrument: 0.67$\rightarrow$0.74, Action: 0.60$\rightarrow$0.63, Tissue: 0.74$\rightarrow$0.79. For \textit{Task 2: Feedback text generation}  (1 [opposite/unsafe] - 3 [admissible] - 5 [perfect match] fidelity rubric against human trainer), GPT-4o from video alone scores 2.17; IAT conditioning reaches 2.44 (+12.4\%), increasing the admissible generations with score $\geq$3: 21\%$\rightarrow$42\%. Traditional metrics also improve: Word Error Rate (WER): $\downarrow$15–31\% and ROUGE (phrase/substring overlap): $\uparrow$9–64\%. Grounding generation in explicit IAT structure improves fidelity and yields clinician-verifiable rationales, supporting auditable use in surgical training.
\end{abstract}

\begin{keywords}
Surgical training; Feedback generation; Action triplets (IAT); Video understanding; Surgical instrument tracking
\end{keywords}

\paragraph*{Data and Code Availability}
Due to privacy restrictions, data is available upon request. The code is publically available \href{https://anonymous.4open.science/r/automating_natural_language_surgical_feedback/README.md}{here}.

\paragraph*{Institutional Review Board (IRB)}
The data used was collected under IRB (details anonymized)

\vspace{-8pt}
\section{Introduction}
\vspace{-4pt}
\label{sec:intro}

\begin{figure*}[ht!]
\centering
\includegraphics[width=\textwidth]{figures/pipeline_overview.png}
\vspace{-16.0pt}
\caption{\textbf{Structure-aware pipeline for clinically aligned surgical feedback.}
\textbf{(1) Multimodal inputs:} video, inferred instrument motion, and procedure/task context are encoded and fused. 
\textbf{(2) Clinically grounded representation:} the fused features yield an \emph{Instrument–Action–Tissue (IAT)} triplet summarizing the tool–tissue interaction.
\textbf{(3) Feedback generation \& evaluation:} predicted IATs condition an LLM to produce trainer-style feedback, assessed with a clinician-aligned \emph{fidelity} and standard text metrics.}
\label{fig:work_overview}
\vspace{-10.0pt}
\end{figure*}


% Setting
\paragraph{Importance:}

High-quality intraoperative feedback from the surgical trainer is pivotal for improving trainee performance and long-term skill acquisition. Real-time trainer feedback aimed at modifying trainee behavior helps avoid errors \citep{wong2023development}, and the quality of feedback is linked to intraoperative performance \citep{bonrath2015comprehensive}, long-term learning outcomes \citep{agha2015role}, and operative outcomes via communication quality \citep{d2020evaluating}. Automatically generation natural, trainer-style feedback promises timely, accessible, and consistent guidance at scale—extending expert coaching beyond what busy trainers can provide in real time—while mitigating the inefficiency and rater biases inherent to manual assessment \citep{chinh2019ways}. Realizing this promise requires approaches that leverage clinically meaningful representations, so that generated guidance remains clinically grounded, interpretable, and auditable.


% \paragraph{Importance:} Feedback in surgery impacts surgeon performance, learning trajectory, and patient outcomes

% \paragraph{Challenges:}
% Trainer–trainee feedback is free-form language with highly variable surface forms (e.g., \emph{bleeder} vs. \emph{vein}), while the surgical scene is complex and unfolds over time with instrument-tissue interactions. Off-the-shelf VLMs often miss procedure and task context and struggle to ground text in concrete visual evidence, which undermines clinical trust. Moreover, generic text overlap metrics (e.g., WER/ROUGE) correlate weakly with \emph{clinical fidelity}, making evaluation non-trivial.

\paragraph{Challenges:}
Surgical feedback is high-stakes: guidance must be technically correct and grounded in the live operative scene. In practice, feedback is spontaneous, conversational speech that entangles clinically critical \emph{semantics}—which instrument, which action, which target—with surface \emph{syntax} (style, tone, hedges) \citep{wong2023development}, while the scene itself is visually complex and evolves through tightly coupled instrument–tissue interactions \citep{ma2022surgical}. Large, diverse corpora of synchronized surgical video and trainer feedback are rare due to privacy/IRB constraints and the cost of expert annotation, yielding \emph{data scarcity} and amplifying \emph{domain shift} between general purpose and surgery-specific video-language representations \cite{philipp2022dynamic}. Off-the-shelf VLMs often miss procedure/task context and lack mechanisms to bind utterances to concrete visual evidence under these shifts \citep{kiyasseh2023vision}. Moreover, text-overlap metrics (e.g., WER/ROUGE) poorly reflect clinical correctness, motivating structure-aware, clinically grounded representations (e.g., Instrument–Action–Tissue semantics) and clinician-aligned evaluation.


% \paragraph{Challenges:} 
% - surgical feedback is high-stakes domain, where the technical correctness of the guidance if of highest importance
% - yet real-world feedback is delivered as unstructured and spontaneous verbal intercommunication surgical room
% - such informal delivery, makes it challenging to separate key information form surface level delivery 
% - surgical feedback delivered live in the surgical room, has important semantic components as well as syntactic delivery - 
% - judging the correctness of feedback delivered in chalengig as simplem language alignment metrics popular in traslation or captioning are insufficient to separate clinically crucial content from arbitrary delivery aspects.


\paragraph{Our Approach:}

We introduce a \emph{structure-aware pipeline}%\firdavs{from AH, need to clarify 'structure-aware'}
\footnote{'structure-aware' - using explicit, clinically meaningful intermediate schema to guide perception and generation.} that (i) learns a feedback-induced surgical action ontology from real trainer\,$\to$\,trainee transcripts and (ii) uses that structure to guide natural language feedback generation from surgical videos. 

An overview of our feedback generation pipeline is depicted in Fig. \ref{fig:work_overview}. We first train a video$\rightarrow$IAT predictor that fuses three inputs: (1a) video frames from endoscopic camera (mean-pooled embeddings), (1b) \emph{instrument motion tracks} derived by estimating depth and tracking multi-point trajectories (details in Fig. \ref{fig:motion_tracking}), and (1c) \emph{clinical context} (procedure and local task) as text embeddings. These streams are concatenated with an MLP to produce multi-head predictions of the (2d) \emph{Instrument–Action–Tissue (IAT)} triplet. The predicted triplets then condition GPT-4o to generate natural language feedback, with an uncertainty gate forwarding only confident triplets to mitigate hallucinations; outputs are compared to trainer ground truth using a clinician-aligned 1–5 \emph{fidelity} score and secondary WER/ROUGE (3e).

To enable this pipeline, we automatically mine \emph{Instrument–Action–Target (IAT)} mentions from trainer\,$\to$\,trainee teaching transcripts delivered in 33 real surgeries collected by \cite{wong2023development}. We cluster various mentions into normalized categories, yielding a data-driven dictionary aligned with clinical language which supports Video$\rightarrow$IAT mapping. 

% \paragraph{Findings:}
% \begin{itemize}[leftmargin=*, itemsep=0.0mm, topsep=5pt]
%     \item Temporal instrument tracking yields consistent IAT gains across backbones. With \textbf{SurgVLP}: Instrument AUC $0.66\!\to\!0.73$ (+10.8\%), Action $0.61\!\to\!0.64$ (+4.6\%), Tissue $0.73\!\to\!0.79$ (+7.7\%). With \textbf{PeskaVLP}: $0.67\!\to\!0.73$ (+8.77\%), $0.61\!\to\!0.63$ (+2.79\%), $0.74\!\to\!0.79$ (+6.59\%).
%     \item Structure-aware prompting improves generated feedback. GPT-4o(\emph{video}) scores 2.17 on the 1–5 fidelity rubric; adding IAT raises this to 2.23 (+3.0\%), and uncertainty-gated IAT to 2.32 (+7.1\%). The share of outputs rated $\ge\!3$ increases from 20.6\% to 33.3\%, and $\ge\!4$ from 0.3\% to 3.1\%. WER decreases by 15–18\% and ROUGE increases by 10–17\% relative to video-only (secondary metrics).
% \end{itemize}


\paragraph{Findings:}
\begin{itemize}[leftmargin=*, itemsep=-0.5mm, topsep=2pt]
    \item \textbf{IAT triplet recognition from video:} Adding temporal instrument tracking and surgical context yields consistent gains across backbones (Table \ref{tab:video_iat_auc_gain_results})—roughly \emph{+0.07–0.08 AUC} for Instrument (\(\sim\!+10\)–\(12\%\)), \emph{+0.02–0.03} for Action (\(\sim\!+4\)–\(5\%\)), and \emph{+0.05–0.09} for Tissue (\(\sim\!+7\)–\(13\%\)).
    
    \item \textbf{Feedback generation:} Structure-aware prompting raises scores on 1–5 fidelity rubric (Table \ref{tab:alignment_text_scores}) from \(\mathit{2.17}\) (video-only) to \(\mathit{2.42}\) with high-confidence triplets (\(+12.4\%\)), increasing the share of admissible ($\ge\!3$: \(+22\) pp) and high-quality feedback ($\ge\!4$: \(+3\) pp). Secondary metrics also improve (WER \(\downarrow\) \(31\%\); ROUGE \(\uparrow\) \(64\%\)).
\end{itemize}

% \paragraph{Findings:}
% \begin{itemize}[leftmargin=*, itemsep=0.0mm, topsep=5pt]
%     \item We show that normalizing unstructured free-text real-world surgical feedback as surgical action triplet improves generation alignment with surgical experts by XX\% over end-to-end competitive surgical VLM finetuning.

%     \item We show the feasibility of leveraging llm-as-judge for clinically meaningful evaluation of generation alignment with expert ground-truth and introduce further refinement strategies.  
% \end{itemize}

% \paragraph{Contributions:}
% \begin{itemize}[leftmargin=*, itemsep=0.2em, topsep=4pt]
%     \item \textbf{Surgeon-aligned feedback from video:} To the best of our knowledge, the first automated system that delivers surgeon-aligned natural-language feedback in robot-assisted surgery from operative video with interpretable grounding.
%     \item \textbf{Two-step, structure-aware framework:} (Step 1) extract interpretable Instrument–Action–Target (IAT) triplets from video via multimodal fusion (procedure/task text, appearance, and depth\,+\,instrument trajectories); (Step 2) generate controlled LLM feedback conditioned on calibrated triplets with uncertainty gating.
%     \item \textbf{Feedback-induced ontology:} Mine and cluster real trainer$\to$trainee transcripts into normalized IAT tags, improving recognition robustness and aligning outputs with clinical language.
%     \item \textbf{Clinically relevant evaluation:} Introduce an interpretable, surgery-specific LLM-as-judge scoring of feedback alignment with surgical ground truth, reported alongside a clinician-aligned 1–5 fidelity rubric.
%     \item \textbf{Safety and interpretability:} Provide evidence-linked rationales by tracing each feedback sentence to predicted triplets and motion cues, supporting auditability and clinical review.
% \end{itemize}


\paragraph{Contributions:}
\begin{itemize}[leftmargin=*, itemsep=-0.5em, topsep=2pt]
    \item \textbf{Surgeon-aligned feedback from video:} To the best of our knowledge, we are the first to propose an end-to-end generation of natural-language feedback in robot-assisted surgery, grounded in interpretable IAT triplets and motion cues.
    \item \textbf{Two-step, structure-aware framework:} (1) video, procedure/task text, instrument motion$\rightarrow$IAT prediction; (2) controlled LLM feedback generation conditioned on triplets.
    \item \textbf{Clinically grounded evaluation:} A reproducible protocol combining a clinician-aligned 1–5 fidelity rubric with an interpretable, surgery-specific LLM-as-judge alignment score.
\end{itemize}

% \paragraph{Contributions:} 
% \begin{itemize}[leftmargin=*, itemsep=0.0mm, topsep=5pt]
%     \item To the best of our knowledge, we are the first to demonstrate an automated approach to deliver surgeon-aligned natural language feedback in robot-assisted surgery.
    
%     \item  We introduce a novel 2-step framework, combining structured interpretable surgical action triplet extraction from surgical videos (step 1) with controlled LLM natural language feedback generation (step 2), that grounds free-text in surgical knowledge.
    
%     \item We introduce an LLM-as-a-judge interpretable and surgically relevant scoring of natural text feedback alignment with surgical ground truth.

%     %insight about representing natural text surgical feedback as surgical action triplets??
    
% \end{itemize}



\vspace{-8pt}
\section{Related Work}
\vspace{-4pt}
\label{sec:related_work}

%Because it is delivered live and conversationally, feedback must be timely, specific, and clinically correct—properties that make scalable automation attractive for consistent, on-time coaching.

\paragraph{Feedback in Robot-Assisted Surgery.}
Natural-language feedback is the primary medium of trainer guidance in surgery \citep{wong2023development}, and its quality is linked to intraoperative performance \citep{bonrath2015comprehensive} and operative outcomes \citep{d2020evaluating}. Prior work has largely \emph{measured} rather than \emph{delivered} feedback: content categorization \citep{wong2023development,kocielnik2023deep}, delivery-style quantification \citep{knudsen2025mp06,kocielnik2024human}, and multimodal prediction of effectiveness \citep{gupta2025multi}. On the delivery side, rubric-based tools (e.g., EASE) support targeted coaching \citep{haque2022assessment}; wizard-of-oz studies show real-time standardized coaching can help \citep{laca2022using}; early automated systems provide narrow, clip-level video feedback \citep{ma2024artificial}; and complementary hardware work explores force feedback \citep{servais2025novel}. We instead generate \emph{surgeon-aligned natural-language feedback} directly from operative video by grounding an LLM in clinically meaningful \emph{Instrument–Action–Target} structure predicted via multimodal fusion.



\paragraph{Vision--Language Models in Surgery.}
Recent surgical VLMs target different goals. \textit{GP-VLS} trains on six surgery-focused datasets and evaluates with \textit{SurgiQual}, showing strong knowledge and vision–language performance \citep{schmidgall2024gp}. \textit{SurgRAW} uses a multi-agent, chain-of-thought framework with retrieval to reduce hallucinations across workflow tasks such as instrument/action recognition and outcome assessment \citep{low2025surgraw}. \textit{Surgical-LVLM} adapts a large VLM with VP-LoRA and a token-interaction module to couple answers with localized evidence, achieving SOTA on EndoVis VQA/VQLA benchmarks \citep{wang2024surgical}. Earlier systems (\textit{SurgicalGPT} \citep{seenivasan2023surgicalgpt}, \textit{Surgical-VQA} \citep{seenivasan2022surgical}, \textit{Surgical-VQLA} \citep{bai2023surgical}) often reframe classification datasets or attach heads, yielding descriptive scene understanding rather than prescriptive guidance. In parallel, foundational surgical video models improve representation transfer: \textit{GSViT} pre-trains on 680h with next-frame objectives \citep{schmidgall2024general}; \textit{SurgVLP} aligns 3k hours of lecture video with transcripts \citep{yuan2023learning}; and \textit{PeskaVLP} adds hierarchical knowledge augmentation with procedure-aware, DTW-aligned pretraining \citep{yuan2024procedure}. For feedback, prior video-based work stops at \emph{classification} of effectiveness \citep{kocielnik2023deep, wong2023development}. In contrast, we generate \emph{surgeon-aligned} natural-language feedback from operative video by grounding an LLM in predicted \emph{Instrument–Action–Target} structure and evaluate with a clinician-aligned fidelity rubric.

\paragraph{Surgical Action Triplets.}
Surgical action triplets—〈instrument, action/verb, target〉—are a standard fine-grained representation of tool–tissue interactions in endoscopic/robotic surgery, offering richer context than phase/step labels \citep{nwoye2020recognition}. The community formalized this via CholecTriplet 2021/2022, progressing from recognition (per-frame triplet) to detection (localizing tools and associating verb–target) \citep{nwoye2023cholectriplet2021, nwoye2023cholectriplet2022}. Advances include attention-based association \citep{nwoye2022rendezvous}, mixed-supervised instrument–tissue detection \citep{sharma2023surgical}, and multi-task spatiotemporal models (e.g., MT-FiST) \citep{li2023mt}. Prior work largely stops at triplet prediction from video; in contrast, we (i) \emph{induce a triplet ontology from trainer–trainee transcripts}, (ii) \emph{predict triplets via multimodal fusion}, and (iii) \emph{use triplets to control LLM feedback generation}—turning triplets from an analysis endpoint into a grounding interface for safe, surgeon-aligned natural-language feedback.


%\paragraph{Automated Scoring and Domain Grounding.}


\vspace{-8pt}
\section{Methods}
\vspace{-4pt}
\label{sec:methods}

\begin{table}[t]
\centering
\small
\setlength{\tabcolsep}{9pt}
\renewcommand{\arraystretch}{1.2}
\begin{tabular}{l r r}
\toprule
\textbf{Category} & \textbf{Count} & \textbf{\% Total} \\
\midrule
Lines of Feedback Text            & 4210     & 100.0\% \\
Unique Procedures        & 7        & -- \\
Unique Tasks             & 36       & -- \\
\midrule
Unique Instruments\textsuperscript{*} & 114 (7)   & -- \\
Unique Actions\textsuperscript{*}     & 1107 (21)  & -- \\
Unique Targets\textsuperscript{*}     & 251 (11)  & -- \\
\midrule
Feedback w/ Instrument       & 344      & 8.2\% \\
Feedback w/ Action           & 875      & 20.8\% \\
Feedback w/ Tissue    & 512      & 12.2\% \\
\midrule
Single value triplet           & 1405     & 33.4\% \\
Multiple value triplets        & 416      & 9.9\% \\
\bottomrule
\end{tabular}

\vspace{2pt}
\raggedright
{\footnotesize \textsuperscript{*} Number before parenthesis represents raw counts. Number in parenthesis represents counts after clustering and selection.}
\vspace{-6.0pt}
\caption{Summary statistics of our dataset with breakdowns of counts of IAT triplets extracted.}
\vspace{-8.0pt}

\label{tab:dataset_summary}
\end{table}



\subsection{Data Acquisition}
\vspace{-4pt}
\label{sec:data_acq}
We use authentic trainer$\to$trainee feedback from real robot-assisted surgeries collected by \cite{wong2023development} (Table~\ref{tab:dataset_summary}). Audio was recorded via surgeon-worn wireless microphones and synchronized with endoscopic point-of-view video using an external device integrated with the da Vinci~Xi system \citep{dimaio2011vinci}. In total, 4{,}210 feedback instances were transcribed and paired with procedure labels (e.g., \textit{radical prostatectomy}, \textit{nephrectomy}) and coarse task annotations (e.g., \textit{adenoma dissection}, \textit{closing peritoneum}).


\begin{figure*}[ht!]
\centering
\includegraphics[width=\textwidth]{figures/ontology_extraction_pipeline.png}
\vspace{-16pt}
\caption{\textbf{Surgical ontology extraction from raw trainer feedback.}
\textbf{(a) Triplet Extraction} — GPT\mbox{-}4o parses free-text feedback into one or more \emph{Instrument–Action–Tissue} triplets \([\mathrm{I},\mathrm{A},\mathrm{T}]\), permitting \emph{null} components when unmentioned.
\textbf{(b) Clustering \& Normalization} — a reasoning LLM (Gemini~2.5) clusters semantically related surface forms for each slot (I/A/T), merges them into functionally coherent meta-clusters, and prunes low-frequency categories.
\textbf{(c) Label-Space Mapping} — canonical tags (e.g., \texttt{energy device}, \texttt{coagulate}, \texttt{vein}) and raw$\rightarrow$tag mappings are produced; this normalized label space provides weak supervision for the video$\rightarrow$\,IAT model and conditions feedback generation.}
\label{fig:ontology_extraction}
\vspace{-10pt}
\end{figure*}

\vspace{-8pt}
\subsection{Surgical Feedback Definition}
\label{sec:fbk_def}
We adopt the clinically validated definition of \citet{wong2023development}: surgical feedback is \emph{any dialogue intended to modify a trainee’s thinking or behavior during live surgery}. In our dataset, this comprises real-time trainer$\to$trainee utterances directed to a console-operating trainee and \emph{contextually tied} to the ongoing task to guide actions, decisions, or understanding. Social/irrelevant conversation is excluded.



\vspace{-8pt}
\subsection{Natural Language Surgical Feedback Generation Pipeline}
\label{sec:pipeline}
%- refer to main architecture figure to give an overview of the whole framework \\
As shown in Fig.~\ref{fig:work_overview}, our pipeline (i) fuses multimodal inputs (video, motion, clinical context), (ii) grounds predictions in an interpretable surgical IAT representation, and (iii) evaluates generated trainer-style feedback against trainer references.

\paragraph{(1) Input Modalities.} 
We predict the \emph{Instrument–Action–Tissue (IAT)} triplet from short video clips (10\,s at 5\,fps) by fusing three complementary sources: endoscopic video frames, temporal instrument motion, and clinical context of procedure and task. Next, we describe how each is obtained.

\textbf{(a) Video encoding.}
\label{subsec:video_context}
Frames are passed through a surgically pretrained backbone—\emph{PeskaVLP} \citep{yuan2024procedure} or \emph{SurgVLP} \citep{yuan2025learning}—to obtain per-frame embeddings, which we mean-pool across time into a clip-level \emph{video embedding}. We leverage surgical backbones because general-purpose models exhibit reduced sensitivity to clinically salient events across clips \citep{philipp2022dynamic}.

\textbf{(b) Motion tracks.}
From the same clip we extract multi-point trajectories of instrument motion and embed them with a dedicated temporal motion encoder (LSTM) to represent tool kinematics. \emph{\textbf{Integrating temporal motion tracking is one of our key contributions}} (details in Sec. \Sref{subsec:temporal_tracking}). This step produces \emph{motion embeddings}.

\textbf{(c) Clinical context encoding.}
\label{subsec:clinical_context}
For each clip, we expand the provided \emph{procedure} and \emph{local task} into concise, clinically phrased summaries with GPT\mbox{-}4o (definitions in Tables~\ref{tab:proc_definitions}, \ref{tab:task_definitions_1}--\ref{tab:task_definitions_4}; prompts in Tables~\ref{tab:procedure_definition_prompt}, \ref{tab:task_definition_prompt}), following the knowledge-augmentation strategy of \citet{yuan2024procedure}. We then encode these summaries using the \emph{text encoder of the same surgically pretrained video–language backbone} as the video stream (i.e., \emph{SurgVLP} or \emph{PeskaVLP}) to preserve an aligned vision–text latent space and leverage surgical priors, yielding \emph{procedure} and \emph{task} embeddings.


\paragraph{(2) Clinically grounded representation (IAT triplet).}

We fuse the clip-level \emph{video}, \emph{procedure/task}, and \emph{motion} embeddings and pass the result to three identical MLP heads for I/A/T (3 layers: $64\!\rightarrow\!32\!\rightarrow\!16$). The heads produce the \textbf{(d) predicted Instrument–Action–Tissue} triplet—an interpretable abstraction of \textit{``which instrument did what to which tissue''} that grounds downstream feedback generation. Supervision derives from ground-truth triplets mined from trainer feedback via \emph{\textbf{our contribution in the form of ontology extraction pipeline}} (Sec.~\Sref{sec:ontology_from_raw_feedback}).

\paragraph{(3) Feedback generation and alignment assessment.}
We cast feedback generation as \emph{data-to-text}: GPT\mbox{-}4o is conditioned on (i) \emph{procedure/task} summaries situating the clip in workflow, (ii) predicted \emph{IAT} triplets, (iii) \emph{video frames} from a 10\,s window at 1\,fps, and (iv) a \emph{reference lexicon} plus a few \emph{IAT$\rightarrow$feedback} examples. A single prompt (App.~\ref{app:gpt4o_fbk_gen_prompt}) frames the model as a surgical training assistant, constrains outputs to 1–3 sentences, and steers toward actionable, safety-oriented guidance tied to the observed tool–tissue interaction while avoiding redundancy. Generated feedback is then compared (via ~\ref{tab:feedback_eval_prompt}) to trainer references using a clinician-aligned \emph{fidelity} score and standard NLP metrics (Sec.~\Sref{sec:task_2_setup}).



%The subsequent sections provide details of the key technical contributions.




% \subsection{Ontology Extraction from Unstructured Verbal Feedback Text}
% \label{sec:ontology_from_raw_feedback}
%  - describe how we use GPT-4o to extract the triplets from unstructured natural text feedback \\
%  - clustering with adaptive level of abstraction - describe all the cluster formulations, what balancing we have \\
%  - Maybe a small figure of the cluster sizes and examples of aggregations

%  - TABLE with \# feedback with triplets, breakdown by each triplet component \\
%  - Distribution of frequent terms \\


\vspace{-4pt}
\subsection{Ontology Extraction and Weakly Supervised Label Construction}
\vspace{-2pt}
\label{sec:ontology_from_raw_feedback}

Figure~\ref{fig:ontology_extraction} overviews our \emph{\textbf{novel three-step ontology extraction pipeline}}, which provides a weak supervision labels for Video$\rightarrow$IAT prediction task.

\begin{itemize}[leftmargin=*, itemsep=0.0em, topsep=4pt]

    \item \textbf{Triplet Extraction (Fig \ref{fig:ontology_extraction}.a)} We treat live trainer feedback transcripts as a source of \emph{weak supervision} for surgical action recognition. Each feedback snippet is processed with GPT\mbox{-}4o to extract one or more \emph{Instrument–Action–Target (IAT)} triplets in the form \texttt{[I, A, T]} (prompts in Tables ~\ref{tab:instrument_extraction_prompt}, ~\ref{tab:action_extraction_prompt}, ~\ref{tab:tissue_extraction_prompt}). This converts naturalistic comments into \emph{sparse multi-class labels} suitable for video classification; e.g., \textit{“use your grasper to gently pull back on the peritoneum”} $\rightarrow$ (\textit{grasper}, \textit{gently pull back}, \textit{peritoneum}). As feedback is not designed to enumerate all elements, triplets may be \emph{incomplete}; we permit \emph{null} fields for missing components.

    \item \textbf{Clustering \& Normalization (Fig \ref{fig:ontology_extraction}.b)} The raw extractions exhibit substantial lexical variation (e.g., \emph{“buzz”/“burn”/“coagulate”} and long-tail distributions, requiring both grouping of semantically related mentions and normalization of exact synonyms. We use Gemini 2.5 Pro~\citep{comanici2025gemini} for clustering and ontology construction, inspired by ~\cite{babaei2024llms4om, yang2024neural}. We introduce a semi-automated two-step procedure. First, the LLM clusters surface forms into fine-grained, semantically coherent groups (prompt in Table ~\ref{tab:initial_clustering_prompt}). Second, with few-shot prompting (Table ~\ref{tab:merge_clustering_prompt}), it merges these into relevant meta-clusters, followed by elbow-based pruning to drop low-frequency categories (Figure ~\ref{fig:iat_class_counts_with_thresholds}). Cluster coherence comparison against other methods can be found in Table~\ref{tab:clustering_coherence}, App.~\ref{app:ontology_extraction_details}.

    \item \textbf{Label-space Mapping (Fig \ref{fig:ontology_extraction}.c)} The resulting hierarchy maps varied surface forms to canonical, clinically meaningful tags (see App. \ref{app:ontology_tag_to_mention}), balancing fidelity to nuance (fine-grained clusters) against label frequency needed for robust video classification (meta-clusters). We preserve links across raw feedback text and canonical tags—yielding a normalized label space for video$\rightarrow$IAT supervision and  conditioning of feedback generation.



\end{itemize}


\begin{figure*}[ht!]
\centering
\includegraphics[width=\textwidth]{figures/temp_motion_tracking.png}
\vspace{-20pt}
\caption{\textbf{Surgical instrument temporal motion tracking pipeline.}
\textbf{(a)} \emph{Input video frames} from the endoscopic view are processed to capture tool appearance and motion.
\textbf{(b)} A \emph{scene depth map} is estimated (Depth Anything) to initialize spatially consistent point tracking.
\textbf{(c)} \emph{Joint point tracking} of instrument keypoints is performed across frames using CoTracker. 
\textbf{(d)} The resulting \emph{motion trajectories} capture fine-grained temporal dynamics of instrument movement. 
\textbf{(e)} An LSTM encodes these trajectories into compact \emph{motion embeddings} for downstream modeling.}
\label{fig:motion_tracking}
\vspace{-10pt}
\end{figure*}

\vspace{-10pt}
\subsection{Temporal Instrument Motion Tracking.}
\label{subsec:temporal_tracking}
 % - Vision model that extract the triplets form the video \\
 % - using pre-traiend/general-purpose flexible vision models \\
 % - single vs multi-task training \\
 % - handling missing triplets \\
 % - temporal tracking
 
Figure~\ref{fig:motion_tracking} illustrates our \textbf{\emph{novel pipeline for extracting instrument motion trajectories}} from surgical video. While video and context embeddings capture visual and procedure priors, they underutilize the rich kinematics of surgical tools. We contribute with a dedicated \emph{motion stream} in five sequential stages:

\begin{itemize}[leftmargin=*, itemsep=0.0em, topsep=4pt]
    \item \textbf{Input frames (Fig.~\ref{fig:motion_tracking}.a)} Video clips (10s at 5 fps) provide the raw input for motion extraction.
    \item \textbf{Scene Depth Map (Fig.~\ref{fig:motion_tracking}.b)} We pre-emphasize metallic tools by dimming the first frame (distance-to-gray heuristic) and then run DepthAnything \citep{yang2024depth} to produce a dense depth map, providing geometric grounding and more reliable instrument point initialization.
    
    \item \textbf{Joint point tracking (Fig.~\ref{fig:motion_tracking}.c)} From the depth map, we construct an \emph{instrument-edge mask} via OpenCV edge detection with circular contouring. Within this mask, CoTracker \citep{karaev2024cotracker} tracks a uniform $20{\times}20$ grid of candidate points across the clip, discarding those outside the mask.
    
    \item \textbf{Motion trajectories (Fig.~\ref{fig:motion_tracking}.d)} The tracked points produce dense temporal trajectories. A 
    \emph{kinematic filter} %\rafal{can we cite, is this off-the-shelf} \firdavs{i'm not sure if off-the-shelf. I just tried it and it worked} 
    selects the top 50\% of points with the largest displacement magnitude, retaining instrument tracks and filtering out background.

    \item \textbf{Motion embeddings (Fig.~\ref{fig:motion_tracking}.e)} The filtered trajectories (2D coordinates over time, optionally augmented with depth at $t{=}0$) are encoded by a 10-layer LSTM into compact \emph{motion embeddings}. %We decided on this layer count as we found it is in this range the model is most uncertainty calibrated.
\end{itemize}

% \subsection{Data-to-Text Natural Feedback Generation from Clinically Grounded Representations}
% \label{sec:data_to_text_gen}
%  - input of structured knowledge: [procedure][instrument][action][target][delivery] \\
%  - LLM generator model an prompting \\
%  - surgical feedback grounded contextual generation \\
%  - controlled delivery style based on quality feedback dimensions \\

%\paragraph{Prompting framework.}
%We employ a large language model (GPT-4o) conditioned by a structured prompt (Appendix \~), which frames the model as a surgical training assistant. The prompt enforces domain grounding, restricts outputs to 1–3 sentences, and emphasizes actionable, pedagogical guidance (e.g., “adjust the angle to reduce traction” rather than “incorrect needle driving”). The model is instructed to integrate visual, structural, and contextual cues while avoiding redundancy or irrelevant commentary.

%\paragraph{Controlled delivery.}
%Across all conditions, style control is enforced through prompt constraints and exemplar guidance, ensuring that outputs are \emph{clear}, \emph{specific}, and \emph{actionable}—qualities emphasized in the surgical education literature. This design enables fair comparison across models and highlights the incremental value of clinically grounded IAT structure in improving fidelity scores.



% \subsection{Clinically Grounded Automated Surgical Feedback Alignment Scoring}
% \label{sec:llm_scoring}

% Evaluating generated feedback requires metrics that reflect \emph{clinical fidelity} rather than superficial text overlap. While standard NLP measures such as Word Error Rate (WER) and ROUGE capture literal overlap, they are insufficient to judge whether the feedback preserves the intended surgical action. We therefore design an automated scoring framework in which a large language model (LLM) acts as a domain-aware evaluator, assigning scores on a 1–5 scale based on semantic and clinical alignment between generated and trainer-provided feedback (Table~\ref{tab:alignment_text_scores}).


% \paragraph{LLM-as-judge protocol.}
% We prompt GPT-4o with explicit grading criteria (Appendix~A) that define five levels of alignment:
% \textbf{(1) Opposite/unsafe}, when generated feedback communicates the reverse or clinically dangerous action;
% \textbf{(2) Wrong/mismatched}, when the proposed action is of a different type or modality;
% \textbf{(3) Partially aligned}, when the general intent is conveyed but key details are missing or added;
% \textbf{(4) Mostly aligned}, when only minor phrasing or emphasis differs; and
% \textbf{(5) Perfectly aligned}, when the generated statement fully matches the expert reference in action, target, and intent.
% The model outputs only the numeric score, enabling automatic batch evaluation.

% \paragraph{Handling negations.}
% A limitation of our current system is that triplet-based conditioning does not reliably capture negated instructions (e.g., “don’t grasp the artery”). To prevent spurious penalties in evaluation, we filtered out trainer feedback that is explicitly negated. These “is\_negation” labels were obtained with a dedicated LLM classifier that tags each feedback statement as negation (\texttt{True}) or non-negation (\texttt{False}) based on the presence of prohibitive language such as “don’t,” “avoid,” or “stop.” Only non-negated pairs were retained for scoring.

\vspace{-14pt}
\section{Experimental Setup}
\vspace{-4pt}
\label{sec:experiment_setup}

% \subsection{Training and Implementation Details}
% Each clip spans 10 seconds at 5 fps. Unless noted, all heads are independent and trained with per-head cross-entropy.
% \rafal{training epochs, batch size, learning rates}
% \rafal{training scheduler, if any}
% \rafal{stopping criteria}
% \rafal{split per model (peska,surgvlp if nneed) or task (Video to IAT, FB gen. If shared say same setup for both models.}

% \rafal{Mention the version of GPT-4o, used for all steps, mention the Gemini.2.5 version with reference}

% \subsection{Training and Implementation Details}

% All models are trained with a fixed random seed (0) for reproducibility. We use `GPT-4o` (gpt-4o-2024-11-20) for all LLM-based generation and evaluation tasks (IAT extraction, context summarization, feedback generation, LLM-as-judge scoring, etc) and `Gemini 2.5 Pro` (gemini-2.5-pro) for the ontology clustering step.

% \parahead{(1) Video $\rightarrow$ IAT Prediction.} The models for this task are trained and evaluated using a 5-fold stratified cross-validation scheme. Each of the three heads (Instrument, Action, Tissue) is trained as an independent multi-class classifier.
% \begin{itemize}[leftmargin=*, itemsep=-0.3em, topsep=2pt]
%     \item \textbf{Context-Only Models:} For baselines that fuse video and clinical context embeddings without temporal tracking, we use an `MLPClassifier` from Scikit-learn. The network consists of three hidden layers with (64, 32, 16) units respectively, using a ReLU activation function and the Adam optimizer, trained for a maximum of 1000 iterations.
%    \item \textbf{Temporal Tracking Model (Ours):} Our full model uses a two-stage hybrid approach to incorporate motion. \textbf{Stage 1 (Feature Extraction):} We first train a PyTorch fusion LSTM + embedding model to learn a compact representation of instrument motion. This model's core is a 10-layer LSTM with 32 hidden units. It is trained for 20 epochs (Adam optimizer, LR $1 \times 10^{-3}$, batch size 8) to process raw instrument coordinate sequences. After training, we use the LSTM component as a fixed feature extractor to generate a motion embedding for each video clip. \textbf{Stage 2 (Classification):} These motion embeddings are concatenated with the corresponding video and clinical context embeddings. A Scikit-learn `MLPClassifier` is then trained on this final combined feature vector to perform the classification. This MLP's architecture is identical to our context-only baselines: three hidden layers (64, 32, 16) with ReLU activation, trained for up to 1000 iterations.
% \end{itemize}

% \parahead{Task 2: Feedback Generation.} All fine-tuned models are trained for three full passes over the training data unless otherwise specified.
% \begin{itemize}[leftmargin=*, itemsep=-0.3em, topsep=2pt]
%     \item \textbf{VQA LLaMA (11B):} This baseline uses a pre-trained `unsloth/llama-3.2-11b-vision-instruct-bnb-4bit` model. We frame the task as visual question answering, prompting the model with the procedure, task, and a single video frame to generate the corresponding feedback. The model is fine-tuned using Low-Rank Adaptation (LoRA, rank=16) on all self-attention projection layers (`q\_proj`, `k\_proj`, `v\_proj`, `o\_proj`, etc.). From each 10-second video clip, we create 10 separate training instances by uniformly sampling 10 frames and pairing each frame individually with the ground-truth feedback. Training is performed using an 8-bit AdamW optimizer with a learning rate of $2 \times 10^{-4}$ and a linear scheduler.
%     \item \textbf{SurgVLP+GPT-2:} This baseline is a video captioning model composed of a SurgVLP encoder (ResNet-50 backbone) and a standard GPT-2 decoder. A trainable two-layer mapping network translates the video embedding into a soft prompt (prefix length of 8 tokens) for the decoder. The video embedding is derived by mean-pooling the features of 3 uniformly sampled frames from each clip. The entire model—encoder, mapper, and decoder—is fine-tuned end-to-end for 30 epochs using an AdamW optimizer with distinct learning rates for the mapper ($3 \times 10^{-4}$) and the language model ($5 \times 10^{-6}$), with a cosine learning rate schedule.
% \end{itemize}



% \subsection{Evaluation Protocol}
% \label{sec:eval_protocol}

% \parahead{Task 1: Video $\rightarrow$ IAT Prediction}
% \label{sec:task_1_setup}
% \noindent\textbf{Conditions:} All variants use identical data splits and training schedules. Results are reported for both backbones (SurgVLP, PeskaVLP) in Table~\ref{tab:video_iat_auc_gain_results}.
% \begin{itemize}[leftmargin=*, itemsep=-0.3em, topsep=2pt]
%     \item \emph{Vision}: video embeddings only.
%     \item \emph{+ Procedure} and \emph{+ Task}: adds procedure and task text embeddings (conditioning follows \cite{yuan2024procedure}, adapted to our real-world feedback).
%     \item \emph{+ Temporal Tracking (ours)}: adds depth-informed multi-point instrument trajectories.
% \end{itemize}


% \noindent\textbf{Metrics: }\textit{AUC} per head (Instrument, Action, Tissue), with mean$\pm$STD over 3 folds—robust to class imbalance, summarizes separation across thresholds.


% \parahead{Task 2: Feedback Generation}
% \label{sec:task_2_setup}
% \noindent\textbf{Conditions.} Comparisons appear in Table~\ref{tab:alignment_text_scores}.

% \begin{itemize}[leftmargin=*, itemsep=-0.3em, topsep=2pt]
%     % \item \emph{ViT+GPT-2}: we explored (frozen ViT/LM with soft prompts), (unfrozen LM), and (unfrozen both); we report the best variant.
%     \item \emph{VQA LLaMA 3.2 (11B)}: general VQA VLM fine-tuned with LoRA on video$\rightarrow$feedback pairs.  %\rafal{We need details in appendix} \firdavs{I added details in section 4.1 which can probably be moved to appendix to use less space on irrelevant info}%most weights frozen due to limited data ($\sim$4.2k, Table~\ref{tab:dataset_summary}).
%     \item \emph{SurgVLP+GPT-2}: surgical image encoder + LM decoder; best setting reported (frozen video, unfrozen LM); SurgVLP text encoder used for procedure/task embeddings.
%     \item \emph{GPT-4o (video+context)}: prompted baseline with the same video and clinical context as above, but \emph{without} our triplet conditioning.
%     \item \emph{GPT-4o + IAT}: IAT-conditioned prompting.
%     \item \emph{GPT-4o + IAT + confidence}: uncertainty-gated IAT conditioning to reduce hallucinations.
% \end{itemize}

% \noindent\textbf{Metrics:} \textit{Fidelity (1–5)}: clinician-aligned \emph{LLM-as-judge} score (GPT-4o) of semantic/clinical alignment between generated and trainer feedback (App.~\ref{app:gpt4o_fbk_gen_prompt}); higher is better. %We filter explicitly negated trainer references to avoid penalizing prohibitions (e.g., “don’t grasp…”).
% \textit{WER}: word error rate vs.\ reference; lower is better.
% \textit{ROUGE-Recall}: phrase/substring overlap; higher is better. %(Both are reported as secondary text overlap signals and do not, by themselves, guarantee clinical correctness.)

\begin{table*}[ht!]
\small
\centering
\begin{tabular}{llcccccc}
\toprule
\textbf{Base Model} & \textbf{Context} & 
\multicolumn{2}{c}{\textbf{Instrument}} & 
\multicolumn{2}{c}{\textbf{Action}} & 
\multicolumn{2}{c}{\textbf{Tissue}} \\
\cmidrule(lr){3-4} \cmidrule(lr){5-6} \cmidrule(lr){7-8}
& & AUC & Gain & AUC & Gain & AUC & Gain \\
\midrule
\multirow{4}{*}{SurgVLP} 
& Vision & $0.65_{\pm0.02}$ & - & $0.58_{\pm0.02}$ & - & $0.70_{\pm0.01}$ & - \\
& + Procedure & $0.67_{\pm0.02}$ & \uab{3.1\%} & $0.58_{\pm0.02}$ & \dar{0.0\%} & $0.73_{\pm0.01}$ & \uab{4.3\%} \\
& + Task & $0.70_{\pm0.01}$ & \uab{7.7\%} & $0.60_{\pm0.01}$ & \uab{3.4\%}  & $0.76_{\pm0.02}$ & \uab{8.6\%} \\
& + Temporal Tracking (our) & {\boldmath $0.73_{\pm0.03}$} & \uab{12.3\%} & {\boldmath $0.61_{\pm0.01}$} & \uab{5.2\%} & {\boldmath $0.79_{\pm0.01}$} & \uab{12.9\%} \\
\midrule
\multirow{4}{*}{HecVL} 
& Vision & $0.68_{\pm0.04}$ & - & $0.60_{\pm0.01}$ & - & $0.74_{\pm0.02}$ & - \\
& + Procedure & $0.68_{\pm0.03}$ & \dar{0.0\%} & $0.60_{\pm0.01}$ & \dar{0.0\%} & $0.76_{\pm0.02}$ & \uab{2.7\%} \\
& + Task & $0.71_{\pm0.04}$ & \uab{4.4\%} & $0.61_{\pm0.01}$ & \uab{1.7\%}  & $0.77_{\pm0.03}$ & \uab{4.1\%} \\
& + Temporal Tracking (our) & {\boldmath $0.74_{\pm0.03}$} & \uab{8.8\%} & {\boldmath $0.62_{\pm0.01}$} & \uab{3.3\%} & {\boldmath $0.77_{\pm0.01}$} & \uab{4.1\%} \\
\midrule    
\multirow{4}{*}{PeskaVLP} 
& Vision & $0.67_{\pm0.03}$ & - & $0.60_{\pm0.02}$ & - & $0.74_{\pm0.02}$ & - \\
& + Procedure & $0.68_{\pm0.03}$ & \uab{1.5\%} & $0.59_{\pm0.02}$ & \dar{1.7\%} & $0.75_{\pm0.02}$ & \uab{1.4\%} \\
& + Task & $0.69_{\pm0.03}$ & \uab{3.0\%} & $0.60_{\pm0.01}$ & \dar{0.0\%} & $0.74_{\pm0.02}$ & \dar{0.0\%} \\
& + Temporal Tracking (our) & {\boldmath $0.74_{\pm0.03}$} & \uab{10.4\%} & {\boldmath $0.63_{\pm0.02}$} & \uab{5.0\%} & {\boldmath $0.79_{\pm0.01}$} & \uab{6.8\%} \\
\bottomrule
\end{tabular}
\vspace{-8.0pt}
\caption{\textbf{Performance of automated Surgical  Action Triplet recognition from surgical video with expert feedback}. AUC and relative gain for Instrument, Action, and Tissue prediction tasks across different context inputs with SurgVLP and PeskaVLP base models. We can see consistent gains from added clinical contest and further gain from our added \emph{\textbf{temporal instrument tracking}}.}
\label{tab:video_iat_auc_gain_results}
\end{table*}

\begin{table*}[h!]
\small
\centering
\begin{tabular}{llcccccccccc}
\toprule
\textbf{Model} & \textbf{Condition} & 
\multicolumn{4}{c}{\textbf{Alignment Score}} &
\multicolumn{4}{c}{\textbf{Text Generation Scores}} \\
\cmidrule(lr){3-6} \cmidrule(lr){7-10}
& & Mean$\uparrow$ & Gain & $\geq$ 3 & $\geq$ 4 & 
WER$\downarrow$ & \%imp. & ROUGE$\uparrow$ & \%imp. \\
\midrule
%ViT+GPT2        & Video & 2.01 &       & 4.3\%  & 2.6\% & 9.54 &        & 0.092 &        \\

VQA Llama & Video+context & $1.93_{\pm.03}$ &       & 10.1\% & 1.4\% & $11.01_{\pm1.0}$ &        & $0.09_{\pm.02}$ &        \\

SurgVLP$_{+LM}$ & Video+context & $1.84_{\pm.03}$ &  & 3.8\% & 2.9\% & $10.54_{\pm0.7}$ &  & $0.11_{\pm.02}$ & \\

GPT-4o & Video+context & $2.17_{\pm.02}$ &       & 20.6\% & 0.3\% & $5.05_{\pm0.3}$  &        & $0.11_{\pm.01}$ &        \\
\midrule
GPT-4o      & +(I,A,T)   & $2.23_{\pm.02}$ & \uab{2.8\%} & 25.1\% & 1.7\% & $4.27_{\pm0.2}$ & \dab{15.4\%} & $0.12_{\pm.01}$ & \uab{9.1\%} \\
GPT-4o       & Context+(I,A,T)      & {$2.33_{\pm.02}$} & \uab{7.4\%} & 32.7\% & 2.4\% & $4.18_{\pm0.2}$ & \dab{18.2\%} & $0.13_{\pm.01}$ & \uab{16.5\%} \\
GPT-4o       & +confidence gate      & {$2.44_{\pm.03}$} & \uab{12.4\%} & 42.0\% & 2.9\% & $3.47_{\pm0.4}$ & \dab{31.3\%} & $0.18_{\pm.01}$ & \uab{63.6\%} \\
\bottomrule
\end{tabular}
\vspace{-8.0pt}
\caption{\textbf{Performance of our  IAT triplet grounded Surgical Feedback Generation.} Comparison of baselines and our methods. Alignment Score (LLM-as-a-judge) and text generation metrics (WER, ROUGE) are reported. Gains and improvements are relative to the best baseline (GPT-4o prompt, Video+context).}
\vspace{-10.0pt}
\label{tab:alignment_text_scores}
\end{table*}

% \subsection{Evaluation Protocol}
% \label{sec:eval_protocol}

All models are trained with a fixed random seed (0) for reproducibility, using GPT-4o (gpt-4o-2024-11-20) for LLM-based tasks (context definitions, triplet extractions, feedback generation) and Gemini 2.5 Pro (gemini-2.5-pro) for ontology construction. Full implementation details, including hyperparameters and specific architectures, are provided in Appendix~\ref{apd:training_details}.

\parahead{Task 1: Video $\rightarrow$ IAT Prediction}
\label{sec:task_1_setup}
We frame IAT prediction as a multi-class classification task with three independent heads (for Instrument, Action, and Tissue) trained on fused multimodal embeddings. The evaluation follows a 5-fold stratified cross-validation scheme to ensure robust performance estimates. We use a two-stage hybrid model for incorporating motion: first, an LSTM is trained as part of a larger fusion architecture to learn a task-relevant motion representation. Then, this trained LSTM component is used as a fixed feature extractor to generate motion embeddings, which are fused with video and text embeddings to train a final MLP classifier.

\noindent\textbf{Conditions:} All variants use identical data splits. Results for both SurgVLP and PeskaVLP backbones are in Table~\ref{tab:video_iat_auc_gain_results}.
\begin{itemize}[leftmargin=*, itemsep=-0.3em, topsep=2pt]
    \item \emph{Vision}: MLP trained on video embeddings only.
    \item \emph{+ Procedure} and \emph{+ Task}: Adds procedure and task text embeddings to the MLP input.
    \item \emph{+ Temporal Tracking (ours)}: Our full, two-stage hybrid model which adds the LSTM-generated motion embeddings.
\end{itemize}

\noindent\textbf{Metrics: }\textit{AUC} per head (Instrument, Action, Tissue), with mean$\pm$STD over 5 folds, which is robust to class imbalance.

\parahead{Task 2: Feedback Generation}
\label{sec:task_2_setup}
For this task, we compare two main approaches: (1) fine-tuning existing vision-language models directly on our video-to-feedback pairs, and (2) few-shot prompting of a state-of-the-art multimodal model (GPT-4o), both with and without our proposed IAT structural conditioning. The fine-tuned baselines explore both a general-domain VLM adapted with LoRA and a surgery-specific video captioning architecture trained end-to-end.

\noindent\textbf{Conditions:} Comparisons are shown in Table~\ref{tab:alignment_text_scores}.
\begin{itemize}[leftmargin=*, itemsep=-0.3em, topsep=2pt]
    \item \emph{VQA LLaMA 3.2 (11B)}: A general VLM fine-tuned using Low-Rank Adaptation (LoRA).
    \item \emph{SurgVLP$_{+LM}$}: A surgery-specific video captioning model, fine-tuned end-to-end.
    \item \emph{GPT-4o (video+context)}: A prompted baseline using video and clinical context; no IAT conditioning.
    \item \emph{GPT-4o + IAT}: Our method using IAT-conditioned prompting.
    \item \emph{GPT-4o + IAT + confidence}: Our full method with an uncertainty gate on IAT predictions.
\end{itemize}

\noindent\textbf{Metrics:} \textit{Fidelity (1–5)}: A clinician-aligned \emph{LLM-as-judge} score (see Tab.~\ref{tab:llm_judge_rubric}) for semantic alignment.
\textit{WER} and \textit{ROUGE-Recall} used as secondary scores.

\vspace{-10pt}
\section{Results}
\vspace{-4pt}
\label{sec:results}

\paragraph{Task 1: Video$\rightarrow$IAT Prediction.}
\label{sec:results_task1}
As summarized in Table~\ref{tab:video_iat_auc_gain_results}, adding \emph{procedure/task} context yields modest, consistent gains for \textit{Instrument} and \textit{Tissue} across both backbones, with smaller or mixed changes for \textit{Action}. The \emph{\textbf{largest improvements come from combining context with our temporal tracking}} stream: with \emph{SurgVLP} AUC reaches 0.73/0.61/0.79 for Instrument/Action/Tissue (\,+12.3\%, +5.2\%, +12.9\%), and with \emph{PeskaVLP} 0.74/0.63/0.79 (\,+10.4\%, +5.0\%, +6.8\%). Overall, context helps with recognition of the right instrument and tissue in feedback delivery, while explicit kinematics provide the bulk of the lift—especially for Instrument and Tissue—leaving Action as the hardest subtask. Confusion matrices are in Fig. \ref{fig:cm_iat_combined}.

% \paragraph{Task 2: Feedback Generation.}
% \label{sec:results_task2}
% Table~\ref{tab:alignment_text_scores} shows that the prompted \emph{GPT\mbox{-}4o (video+context)} baseline outperforms the fine-tuned video baselines (VQA LLaMA-11B, SurgVLP+GPT-2). Adding structured conditioning improves quality further. With \emph{IAT-conditioned prompting}, mean \textit{Fidelity} rises to \(2.23{\pm}0.5\) (\(+2.8\%\) over GPT-4o), WER drops by \(15.4\%\) (to 4.27), ROUGE increases by \(9.1\%\) (to 0.12), and the fraction \(\ge\!3\) grows to \(25.1\%\) (\(\ge\!4:\,1.7\%\)). \emph{\textbf{Our full model with IAT + confidence gating yields the best results}}—\(2.32{\pm}0.6\) mean \textit{Fidelity} (\(+7.1\%\)), \(33.3\%\) of outputs \(\ge\!3\) and \(3.1\%\) \(\ge\!4\), with WER reduced to 4.17 (\(17.5\%\) improvement) and ROUGE up to 0.127 (\(16.5\%\) gain). These gains indicate that structured, clinically grounded conditioning—and selectively trusting only high-confidence triplets—modestly improves alignment with trainer feedback while also enhancing conventional text metrics. Crucially, it also provides enhanced interpretability and transparency of feedback grounding.

\vspace{-2pt}
\paragraph{Task 2: Feedback Generation.}
\label{sec:results_task2}

Table~\ref{tab:alignment_text_scores} shows that adding structured conditioning to GPT-4o improves alignment over the video+context baseline. Notably, grounding with the IAT triplet alone (\textit{Fidelity} $2.23\pm0.02$) performs comparably to combining triplets with raw video, while the \textit{Context+(I,A,T)} condition achieves the higher mean \textit{Fidelity} of $2.33\pm0.02$. This suggests that explicit triplet conditioning is more effective than attempting multimodal fusion via GPT-4o with both structured and raw video frame inputs. \emph{\textbf{Our full model with IAT + confidence gating yields the best results.}} Filtering the evaluation set to high-confidence cases (N = 307 down from 1405) further strengthens performance, with a mean \textit{Fidelity} of $2.44\pm0.03$ (+12.4\%). In this subset, 42.0\% of outputs are rated $\geq3$ and 2.9\% rated $\geq4$. Text generation metrics also improve markedly: WER drops by 31.3\% to $3.47\pm0.4$, and ROUGE rises by 63.6\% to $0.18\pm0.01$. These results highlight that structured, clinically grounded conditioning—when coupled with confidence-based filtering—yields the strongest performance.

%Context improves recognition of tissue and instrument choices that are procedure/task-dependent without changing the supervision.

%This yields the \textit{+Temporal Tracking} rows in Table~\ref{tab:auc_gain_results}, where motion consistently boosts all three components—most notably Instrument and Tissue—by providing explicit evidence of tool–tissue interaction dynamics.

%Incorporating procedure/task context and explicit temporal motion tracking enriches pooled video embeddings with clinically meaningful cues about instrument–tissue interactions, leading to the consistent AUC gains reported in Table~\ref{tab:auc_gain_results}.






%%% ------
% IAT 2 Feedback Text Table
%%% ------







\vspace{-6pt}
\subsection{Additional Inspection and Analysis}

\vspace{-2pt}
\paragraph{Qualitative inspection.}
We manually reviewed generations at the extremes of the fidelity rubric. Perfectly aligned outputs (\textit{score}=5) often arose when the trainer mentioned only a single triplet component (e.g., an action such as ``open''); the model captured this aspect precisely (examples in Table~\ref{tab:iat_feedback_examples}). In contrast, \emph{unsafe} outputs (\textit{score}=1) were rare—\textbf{37/1365} cases—and were overwhelmingly (\textbf{31/37}) triggered by negated trainer instructions (e.g., ``stop'', ``don’t buzz''). Our current IAT representation does not encode negation or ``do-not'' intent, suggesting a useful extension with an explicit \emph{polarity} tag.

\vspace{-2pt}
\paragraph{Calibration and confidence gating.}
The Video$\rightarrow$IAT heads exhibit good-to-fair calibration with Expected Calibration Error (ECE) of roughly 0.07, 0.04, and 0.08 percentage points (lower is better). This \emph{\textbf{supports our use of confidence gating}}: conditioning feedback only on high-confidence triplets yields the best results in Table~\ref{tab:alignment_text_scores} (``\,+IAT + confidence\,'').

% - rating of feedback - good quality, spot inspection, human kappa \\
% - confusion matrices: right-hand confused, many actions \\
% - ontology map - imperfections bladder \\

\vspace{-10pt}
\section{Discussion}
\vspace{-4pt}
\label{sec:discussion}

Our results show that clinically grounded structure enables both recognition and generation: fusing video, procedure/task context, and explicit tool kinematics improves Video$\rightarrow$IAT prediction (Table~\ref{tab:video_iat_auc_gain_results}), and conditioning GPT\mbox{-}4o on the predicted triplets improves \emph{fidelity} of generated feedback beyond strong baselines (Table~\ref{tab:alignment_text_scores}). A score of 3 on our 1–5 rubric denotes \emph{admissible} alignment (captures the trainer’s intent but may miss detail), whereas 5 indicates near-exact match—an idealization that is uncommon even across human trainers \citep{gawad2019inter}.

\vspace{-2pt}
\paragraph{Why a sparse, structured representation?}
We adopt a compact IAT representation because it is \emph{clinically grounded and validated} for modeling tool–tissue interactions in endoscopic/robotic surgery \citep{ nwoye2023cholectriplet2022}; \emph{auditable}, letting each sentence trace to explicit instrument–action–tissue evidence; and \emph{data-efficient} under the heterogeneity of our setting (7 procedures, multiple tasks, and diverse trainer–trainee pairs), abstracting away surface variation while preserving core semantics. Crucially, IATs separate \emph{content} (instrument, action, tissue) from \emph{delivery} (tone, hedges, praise): both matter for feedback effectiveness \citep{wong2023development}, but once the core content is correct and inspectable, delivery style can easily be modulated with modern LLMs. Our ontology is induced from real trainer$\to$trainee language, following use of LLMs in medical annotation \citep{goel2023llms},  and normalized with LLM-based clustering (App.~\ref{app:ontology_extraction_details}), aligning labels with clinical usage and mitigating long-tail infrequent variations.

\vspace{-2pt}
\paragraph{Practical value in clinical settings.}
The pipeline supports \emph{post hoc} review: trainees can receive concise, surgeon-style messages linked to concrete tool–tissue events, complementing sparse real-world feedback and helping trainers standardize coaching \citep{ma2024artificial}. The same structure is amenable to \emph{in-room} assistance:  controlled style preserves naturalistic delivery—features known to influence trainee acceptance \citep{kocielnik2024human, knudsen2025mp06}. Such systems may also reduce senior faculty burden during simulation-based practice.

% drive engagement and acceptnce (deliver diffeent)
% diversity - reuce tedium from repetition (k
% compared to rubric-based, semless integration with current practice

\vspace{-2pt}
\paragraph{Limits of the current representation.}
Two recurrent failure modes surfaced in our inspection. First, \emph{polarity} is not explicit: prohibitions (e.g., “don’t buzz the ureter”) are poorly captured by positive-only IATs, and most unsafe outputs arise from such negations. Second, \emph{granularity} is coarse: degrees of adjustment (“a bit closer”), skill quality, and clinical \emph{criticality} are not represented, which caps the achievable fidelity even with perfect recognition. 
% additional follow up ont e perfret recsnctis, shws scre, of 3.24, suporting that, the rrpreentaion s sexpessiv ena dmost limitaitons come for abstraopnc sneeded due to mwhat can be recognized wfrom video

\vspace{-2pt}
\paragraph{Future directions.}
We see three immediate avenues: (1) enrich the IAT representation with tags for \emph{polarity} (prohibit/encourage), \emph{intensity} (degree/magnitude), and \emph{criticality} (clinical importance); (2) model \emph{permissible alternatives} by collecting multiple valid trainer responses for the same context and scoring clinical usefulness rather than alignment; and (3) incorporate constraint-based reasoning to rule out implausible IAT combinations and enforce procedure- and step-specific safety constraints in context.

\vspace{-12pt}
\section{Conclusion}
\vspace{-4pt}
\label{sec:conclusion}
We present the \textit{first} end-to-end system that generates surgeon-aligned, natural-language feedback directly from operative video and clinical context, grounded in explicit Instrument–Action–Tissue (IAT) semantics. Our contributions—(i) a feedback-induced, clinically normalized IAT ontology, (ii) a multimodal video$\rightarrow$IAT predictor that fuses procedure/task context with temporal instrument motion, and (iii) IAT-conditioned GPT-4o with confidence gating and a clinician-aligned evaluation. These yield better alignment while remaining interpretable and auditable, laying the groundwork for scalable surgical coaching, easing workload, and lowering training costs.



% integration of IAT with skill assessment (also an established abstraciton) may offers an opportunity for a more finegraned feedback around precisio en executionof actions, which coud be a promisitn avenues




% \paragraph{Intentionality of Surgeon Feedback in Particular Moment}
% - separating intention vs discretionary feedback \\
% - feedback exhaustiveness \\

% \paragraph{Data Scarcity and Representation Depth Trade-offs}
% - surgical triplet is a simplification of complex surgical scene and the feedback itself \\
% - lost nuances as the benefits of normalized representaitons with reduced long-train issues \\
% - normalization of surgeon-specific or procedure-specific linguistic patterns \\


% \paragraph{Practical Value in Clinical Settings.}
% - automated feedback in trainee practice (off-line review of videos) \\
% - towards live feedback in surgical room \\

% \paragraph{Limitations and Future Directions.}














\bibliography{bibliography}


\appendix

%%%%%%%%%%%%%%%%%
%%% SECTION 1 %%%
%%%%%%%%%%%%%%%%%
\section{Fidelity Scoring Rubric (LLM-as-a-Judge)}
\label{app:fidelity_rubric}

This appendix specifies the 1--5 \emph{Fidelity} scale used to judge how well a generated message aligns with a trainer’s reference. The evaluator (GPT\mbox{-}4o) compares \emph{only} the requested tool--tissue action(s), ignoring phrasing/style, and outputs a single integer score. The levels below capture semantic/clinical agreement from unsafe/opposite (1) to exact match in intent, action, and target (5). See Table~\ref{tab:llm_judge_rubric}.

\begin{table*}[h!]
\small
\centering
\setlength{\tabcolsep}{6pt}
\renewcommand{\arraystretch}{1.25}
\caption{\textbf{LLM-as-a-judge scoring rubric for generated vs.\ trainer feedback.} 
Evaluator compares the generated message to the expert reference and scores \emph{only} the requested action(s) on a 1--5 faithfulness scale.}
\label{tab:llm_judge_rubric}
\begin{tabular}{
  >{\raggedright\arraybackslash}p{0.27\textwidth}
  >{\raggedright\arraybackslash}p{0.32\textwidth}
  >{\raggedright\arraybackslash}p{0.34\textwidth}
}
\toprule
\textbf{Score} & \textbf{Definition} & \textbf{Examples} \\
\midrule
\textbf{1 — Opposite or Unsafe Action} &
Feedback suggests an action that is opposite in intent or clearly unsafe compared with the ground truth. &
``cut the vein'' vs.\ ``secure the vein''; ``stop'' vs.\ ``continue''; ``only one clip'' vs.\ ``put all the clips'' \\
\addlinespace[2pt]
\textbf{2 — Wrong or Mismatched Action} &
Feedback conveys a different type or modality of action. &
``sweep towards you'' vs.\ ``pull the tissue''; ``buzz the artery'' vs.\ ``clip the artery'' \\
\addlinespace[2pt]
\textbf{3 — Partially Aligned, Missing/Extra Detail} &
Matches the general action but adds or omits key details (amount, precision, target tissue, force). &
``stop the bleed'' vs.\ ``buzz that bleeder''; ``clip to the artery'' vs.\ ``only one clip to artery'' \\
\addlinespace[2pt]
\textbf{4 — Mostly Aligned, Minor Wording Differences} &
Core action and target match; differences are hedging, emphasis, or style only. &
``cauterize this'' vs.\ ``buzz that bleeder''; ``closer to prostate'' vs.\ ``come 1\,mm closer to the prostate'' \\
\addlinespace[2pt]
\textbf{5 — Perfectly Aligned} &
Exactly matches intent, action, and target tissue/instrument. &
``coag the vein'' vs.\ ``buzz that bleeder''; ``move the left hand under the ureter'' vs.\ ``get L hand below ureter'' \\
\bottomrule
\end{tabular}
\end{table*}


%%%%%%%%%%%%%%%%%
%%% SECTION 2 %%%
%%%%%%%%%%%%%%%%%
\section{Ontology Induction and Clustering Benchmarks}
\label{app:ontology_extraction_details}

% To normalize free-form trainer $\rightarrow$ trainee language into a clinically usable label space, we cluster surface forms for \emph{Instrument}, \emph{Action}, and \emph{Tissue} mentions and map them to canonical tags. We compared three clustering pipelines using an embedding-based cluster coherence metric implementation from \cite{terragni2020octis} (higher is better): (i) an unsupervised BERTopic baseline, (ii) an initial LLM-driven clustering \rafal{One sentence of what it is}, and (iii) a refined LLM-driven variant (\emph{Final LLM clustering}) with improved prompts and merge heuristics \rafal{Can you say what is improved, very briefly?}. As shown in Table~\ref{tab:clustering_coherence}, the final approach yields the highest coherence for \textit{Action} and \textit{Tissue} (+0.18 and +0.36 over baseline, respectively) and competitive \textit{Instrument} coherence, so we adopt it to build the feedback-induced IAT dictionary used throughout our modeling pipeline (Sec.~\ref{sec:pipeline}).

To normalize free-form trainer $\rightarrow$ trainee language into a clinically usable label space, we cluster surface forms for \emph{Instrument}, \emph{Action}, and \emph{Tissue} mentions and map them to canonical tags. We compared three clustering pipelines using an embedding-based cluster coherence metric implementation from \cite{terragni2020octis} (higher is better): (i) an unsupervised BERTopic baseline, (ii) an initial LLM-driven clustering, which used a zero-shot prompt to group raw textual mentions into semantically related clusters without domain-specific examples, and (iii) a refined LLM-driven variant (\emph{Final LLM clustering}). The refined variant takes the initial LLM mappings and few-shot examples as input and merges overly nuanced clusters into more general, functionally relevant categories. This two-step approach ensures that the final label space is robust to minor lexical variations and contains categories frequent enough for effective model training, while still preserving core clinical meaning. As shown in Table~\ref{tab:clustering_coherence}, the final approach yields the highest coherence for \textit{Action} and \textit{Tissue} (+0.18 and +0.36 over baseline, respectively) and competitive \textit{Instrument} coherence, so we adopt it to build the feedback-induced IAT dictionary used throughout our modeling pipeline (Sec.~\ref{sec:pipeline}).



% Requires \usepackage{booktabs}
\begin{table*}[h]
\centering
\small
\begin{tabular}{lcccccc}
\toprule
\textbf{Method} & \textbf{Instr.} & $\Delta$ & \textbf{Action} & $\Delta$ & \textbf{Tissue} & $\Delta$ \\
\midrule
BERTopic clustering & 0.49 & 0.00 & 0.56 & 0.00 & 0.50 & 0.00 \\
Initial LLM clustering & \textbf{0.58} & +0.18 & 0.59 & +0.05 & 0.55 & +0.10 \\
Final LLM clustering & 0.55 & +0.12 & \textbf{0.66} & +0.18 & \textbf{0.68} & +0.36 \\
\bottomrule
\end{tabular}
\caption{\textbf{Evaluation of clustering methods for grouping the individual IAT mentions mined from feedback text.} Cluster coherence (higher is better) for ontology induction across the three components of the surgical action triplet. $\Delta$ denotes absolute improvement over the BERTopic baseline. We adopt the  \emph{Final LLM clustering} in the main pipeline.}
\label{tab:clustering_coherence}
\end{table*}


%%%%%%%%%%%%%%%%%
%%% SECTION 3 %%%
%%%%%%%%%%%%%%%%%
\section{Concrete LLM Prompts}
\label{app:llmprompts}

\subsection{GPT-4o Prompt for Surgical Feedback Generation}
\label{app:gpt4o_fbk_gen_prompt}
We provide the prompt used to generate surgeon-aligned natural-language feedback conditioned on \emph{structured knowledge} extracted from the surgical scene. Concretely, the prompt (Table~\ref{tab:feedback_prompt}) conditions GPT-4o on predicted \emph{Instrument–Action–Tissue (IAT)} triplets, procedure and task summaries, optional class definitions, a few reference (IAT$\rightarrow$feedback) examples, and short frame sequences. The model is instructed to return a single, concise (1–3 sentence) trainee-directed message without boilerplate. At inference, only triplets that pass our calibrated confidence gate are injected; otherwise a no-evidence placeholder is used. We apply this same prompt across all experiments reported in the paper.

% Requires in preamble: \usepackage{tcolorbox}
% In preamble:
% \usepackage{tcolorbox}
% \usepackage{enumitem}

\begin{table*}[t]
  \captionsetup{aboveskip=4pt,belowskip=2pt} % requires \usepackage{caption}
  \small
  \centering
  \caption{\textbf{Prompt for surgeon-aligned feedback generation from video and IAT context.}}
  \label{tab:feedback_prompt}
  \begin{tcolorbox}[
    enhanced, 
    width=\textwidth,
    colback=white,
    colframe=black!75!white,
    colbacktitle=black!85!white,
    coltitle=white,
    title=Feedback Generation Prompt,
    fonttitle=\bfseries,
    boxrule=0.4pt,
    arc=0pt, outer arc=0pt,
    % tighten padding
    left=3pt,right=3pt,top=3pt,bottom=3pt,boxsep=2pt,
    before skip=2pt, after skip=2pt
  ]
  \footnotesize % compact text inside box

  \textbf{Role.} You are an expert surgical training assistant specializing in urological procedures performed with the da Vinci surgical system. Your primary function is to analyze surgical scene data—video frames and abstract triplets—and generate concise, actionable, pedagogical feedback for a surgeon in training.

  \medskip
  \textbf{Detailed instructions}
  \begin{enumerate}[leftmargin=*,nosep,label=\arabic*.]
    \item Analyze the visual context: assess instrument position, motion, and tissue state.
    \item Interpret the core event: identify the key tool–tissue interaction.
    \item Consult the lexicon: respect class definitions and terminology.
    \item Situate the task: tailor guidance to the current task and procedure.
    \item Learn from precedent: use (IAT$\rightarrow$Feedback) examples when relevant.
    \item Synthesize actionable feedback: state what to do and why.
    \item Ensure feedback is constructive: specific, supportive, and safety-oriented.
    \item Maintain focus: address the observed event; avoid digressions.
    \item Reduce redundancy: avoid repeating obvious details.
  \end{enumerate}
    \medskip
  \textbf{Formatting instructions}
  \begin{itemize}[leftmargin=*,nosep]
    \item Output a single concise string (1–3 sentences).
    \item Do not include prefixes (e.g., “Feedback:”), bullets, or extra explanations.
    \item Tone: professional, direct, educational.
  \end{itemize}
\medskip
  \textbf{Inputs}
  \begin{itemize}[leftmargin=*,nosep]
    \item \textit{Video Frames} (list of images): sequential frames from the surgical clip.
    \item \textit{IAT Triplet} (tuple): (Instrument, Action, Tissue) for the event.
    \item \textit{Class Definitions} (dict, optional): descriptions for instrument/action/tissue classes.
    \item \textit{Procedure} (str) and \textit{Procedure Definition} (str).
    \item \textit{Task} (str) and \textit{Task Definition} (str).
    \item \textit{Reference Examples} (list): (IAT$\rightarrow$Feedback) pairs.
  \end{itemize}
\medskip
  \textbf{Output}
    \begin{itemize}[leftmargin=*,nosep]
    \item (str) A single string containing actionable surgical feedback.
  \end{itemize}
  \medskip
  {\ttfamily
  Procedure: \{procedure\}\\
  Procedure Definition: \{procedure\_defn\}\\
  Task: \{task\}\\
  Task Definition: \{task\_defn\}\\
  Observed Event (IAT Triplet): \{iat\_triplet\}\\
  Class Definitions: \{class\_definitions\}\\
  Reference Examples: \{reference\_examples\}\\
  Video Frames: \{video\_frames\}\\
  Actionable Feedback:
  }
  \end{tcolorbox}
\end{table*}

\begin{table*}[t]
  \captionsetup{aboveskip=4pt,belowskip=2pt} % requires \usepackage{caption}
  \small
  \centering
  \caption{\textbf{Prompt for generating concise definitions of urologic procedures.}}
  \label{tab:procedure_definition_prompt}
  \begin{tcolorbox}[
    enhanced, 
    width=\textwidth,
    colback=white,
    colframe=black!75!white,
    colbacktitle=black!85!white,
    coltitle=white,
    title=Procedure Definition Prompt,
    fonttitle=\bfseries,
    boxrule=0.4pt,
    arc=0pt, outer arc=0pt,
    left=3pt,right=3pt,top=3pt,bottom=3pt,boxsep=2pt,
    before skip=2pt, after skip=2pt
  ]
  \footnotesize

  \textbf{Role.} You are a urologic surgery educator writing a clear, neutral definition of the named procedure.

  \medskip
  \textbf{Instructions}
  \begin{enumerate}[leftmargin=*,nosep,label=\arabic*.]
    \item State the purpose/indications in one sentence.
    \item Describe the essential operative scope (what is removed, repaired, or reconstructed).
    \item Note common approach variants (e.g., open, laparoscopic, robotic, endoscopic) without steps.
    \item Optionally mention a high-level recovery or outcome consideration in one short clause.
    \item Keep it factual, jargon-light, and generalizable.
  \end{enumerate}
    \medskip
  \textbf{Formatting}
  \begin{itemize}[leftmargin=*,nosep]
    \item Output exactly one paragraph, 3--5 sentences, no lists or prefixes.
    \item Tone: professional, neutral, educational.
  \end{itemize}
    \medskip
  \textbf{Input}
  \begin{itemize}[leftmargin=*,nosep]
    \item \textit{Procedure Name} (str; urology).
  \end{itemize}
    \medskip
  \textbf{Output}
  \begin{itemize}[leftmargin=*,nosep]
    \item (str) Single-paragraph definition covering purpose, scope, approach variants, and (optionally) recovery/outcome.
  \end{itemize}
    \medskip
  {\ttfamily
  Procedure Name: \{procedure\_name\}\\[2pt]
  Definition:
  }
  \end{tcolorbox}
\end{table*}

\begin{table*}[t]
  \captionsetup{aboveskip=4pt,belowskip=2pt} % requires \usepackage{caption}
  \small
  \centering
  \caption{\textbf{Prompt for generating concise definitions of urologic surgical tasks.}}
  \label{tab:task_definition_prompt}
  \begin{tcolorbox}[
    enhanced, 
    width=\textwidth,
    colback=white,
    colframe=black!75!white,
    colbacktitle=black!85!white,
    coltitle=white,
    title=Task Definition Prompt,
    fonttitle=\bfseries,
    boxrule=0.4pt,
    arc=0pt, outer arc=0pt,
    left=3pt,right=3pt,top=3pt,bottom=3pt,boxsep=2pt,
    before skip=2pt, after skip=2pt
  ]
  \footnotesize

  \textbf{Role.} You are a urologic surgery educator writing a clear, neutral definition of the named teaching \emph{task}.

  \medskip
  \textbf{Instructions}
  \begin{enumerate}[leftmargin=*,nosep,label=\arabic*.]
    \item State the task’s purpose in one sentence.
    \item Ground it in key anatomy or structures involved.
    \item Describe the core competency (what the trainee must reliably achieve).
    \item Mention a salient safety or preservation consideration.
    \item Expand abbreviations on first use when ambiguous.
  \end{enumerate}
    \medskip
  \textbf{Formatting}
  \begin{itemize}[leftmargin=*,nosep]
    \item Output exactly one paragraph, 2--4 sentences, no lists or prefixes.
    \item Tone: professional, neutral, educational.
  \end{itemize}
    \medskip
  \textbf{Input}
  \begin{itemize}[leftmargin=*,nosep]
    \item \textit{Task Name} (str; urology).
  \end{itemize}
    \medskip
  \textbf{Output}
  \begin{itemize}[leftmargin=*,nosep]
    \item (str) Single-paragraph task definition covering purpose, anatomy, core competency, and a key safety point.
  \end{itemize}
    \medskip
  {\ttfamily
  Task Name: \{task\_name\}\\[2pt]
  Task Definition:
  }
  \end{tcolorbox}
\end{table*}



\begin{table*}[t]
  \captionsetup{aboveskip=4pt,belowskip=2pt} % requires \usepackage{caption}
  \small
  \centering
  \caption{\textbf{Prompt for extracting \emph{instrument} component of triplet from a feedback line.}}
  \label{tab:instrument_extraction_prompt}
  \begin{tcolorbox}[
    enhanced, 
    width=\textwidth,
    colback=white,
    colframe=black!75!white,
    colbacktitle=black!85!white,
    coltitle=white,
    title=Instrument Extraction Prompt,
    fonttitle=\bfseries,
    boxrule=0.4pt,
    arc=0pt, outer arc=0pt,
    left=3pt,right=3pt,top=3pt,bottom=3pt,boxsep=2pt,
    before skip=2pt, after skip=2pt
  ]
  \footnotesize

  \textbf{Instruction.} You are working in the context of verbal feedback delivered by a trainer to a trainee in a live robot-assystec daVinci surgery. Extract the following aspects from given feedback line:\\
  instrument or tool - identify any mentions of surgical instrument or tool. If no instrument or tool is mentioned, produce \"NONE\" \\
  Make sure you extract all and every surgical instruments or tools including robotic daVinci instruments, make sure to extract mentions of instruments or tools such as catheter, needle, stitches, sutures, robotic arms, graspers, forcepts, retractor, spreader, electrocautery, energy devices, camera, left hand, right hand, 4th arm or others. \\
  Also extract instruments and tools that are strongly implied, even if not mentioned explicitly, based on the action context. \\
  Produce output strictly in the format [instrument 1, instrument 2, ...].

  \medskip
  
  {\ttfamily
  Process this feedback line: \{feedback\_line\}
  }
  \end{tcolorbox}
\end{table*}


\begin{table*}[t]
  \captionsetup{aboveskip=4pt,belowskip=2pt} % requires \usepackage{caption}
  \small
  \centering
  \caption{\textbf{Prompt for extracting \emph{action} component of triplet from a feedback line.}}
  \label{tab:action_extraction_prompt}
  \begin{tcolorbox}[
    enhanced, 
    width=\textwidth,
    colback=white,
    colframe=black!75!white,
    colbacktitle=black!85!white,
    coltitle=white,
    title=Action Extraction Prompt,
    fonttitle=\bfseries,
    % boxrule=0.4pt,
    % arc=0pt, outer arc=0pt,
    left=3pt,right=3pt,top=3pt,bottom=3pt,boxsep=2pt,
    before skip=2pt, after skip=2pt
  ]
  \footnotesize

  \textbf{Instruction.} You are working in the context of verbal feedback delivered by a trainer to a trainee in a live surgery. Extract the following aspects from given feedback line:\\
  action - identify any phrases that explicitly indicate an action the trainee is expected to perform. This may include instructions, commands, or recommendations. If no such actions are present, produce \"NONE\" \\
  Interpret unclear or incomplete feedback as concretely as possible, but avoid introducing assumptions not supported by the text. Interpret phases describing actions (e,g., \"you're gonna\", \"you will\", \"I want you to\", \"I like the\") as instructions for the trainee. \\
  Express extracted actions in the imperative form. Extract just the broad action with optional modifiers (e.g., 'come closer', 'tap litte', 'check left side', 'start doing'), but don't include the object of the action, such as anatomic component or instrument used. \\
  Produce output strictly in the format [action 1, action 2, ...].

  \medskip
  
  {\ttfamily
  Process this feedback line: \{feedback\_line\}
  }
  \end{tcolorbox}
\end{table*}


\begin{table*}[t]
  \captionsetup{aboveskip=4pt,belowskip=2pt} % requires \usepackage{caption}
  \small
  \centering
  \caption{\textbf{Prompt for extracting \emph{tissue} component of triplet from a feedback line.}}
  \label{tab:tissue_extraction_prompt}
  \begin{tcolorbox}[
    enhanced, 
    width=\textwidth,
    colback=white,
    colframe=black!75!white,
    colbacktitle=black!85!white,
    coltitle=white,
    title=Tissue Extraction Prompt,
    fonttitle=\bfseries,
    % boxrule=0.4pt,
    % arc=0pt, outer arc=0pt,
    left=3pt,right=3pt,top=3pt,bottom=3pt,boxsep=2pt,
    before skip=2pt, after skip=2pt
  ]
  \footnotesize

  \textbf{Instruction.} You are working in the context of verbal feedback delivered by a trainer to a trainee in a live robot-assystec daVinci surgery. Extract the following aspects from given feedback line:\\
  tissue, visual body part, or anatomic elements - identify any mentions of tissue, visual body part, or anatomic elements. If none is mentioned, produce \"NONE\" \\
  Make sure you extract all and every tissue, visual body part, or anatomic elements mentiond together with its property, if mentioned, including urether, bladder neck, small prostate, prostate contour, lateral thing, anteiror part or others. \\
  Some mentions are colloquial (e.g., bleeder is vein) or abbreviated (e.g., SV is Seminal Vesicles). Interpret these in the context of abdominal urologic surgery and express in proper medical form. \\
  If the term is ambiguous (e.g., \"lateral thing\" or \"anterior part\"), interpret it in the surgical context and include it as an approximate or general anatomical reference (e.g., \"lateral structure\" or \"anterior structure\"). \\
  Produce output strictly in the format [element 1, element 2, ...].

  \medskip
  
  {\ttfamily
  Process this feedback line: \{feedback\_line\}
  }
  \end{tcolorbox}
\end{table*}


\begin{table*}[h!]
    \captionsetup{aboveskip=4pt,belowskip=2pt}
    \small
    \centering
    \caption{\textbf{Prompt for Step 1: Initial fine-grained clustering of IAT mentions.}}
    \label{tab:initial_clustering_prompt}
    \begin{tcolorbox}[
        enhanced, 
        width=\textwidth,
        colback=white,
        colframe=black!75!white,
        colbacktitle=black!85!white,
        coltitle=white,
        title=Ontology Induction Prompt (Step 1: Fine-Grained Clustering),
        fonttitle=\bfseries,
        boxrule=0.4pt,
        arc=0pt, outer arc=0pt,
        left=3pt,right=3pt,top=3pt,bottom=3pt,boxsep=2pt,
        before skip=2pt, after skip=2pt
        ]
    \footnotesize

    \textbf{Role.} You are an expert in clinical language and surgical ontology design. Your task is to analyze a list of raw textual mentions extracted from surgeon feedback and group them into semantically coherent, fine-grained clusters.
    
    \medskip
    \textbf{Instructions}
    \begin{enumerate}[leftmargin=*,nosep,label=\arabic*.]
        \item You will be given a list of raw text mentions from a specific category: \textbf{Instrument}, \textbf{Action}, or \textbf{Tissue}.
        \item Group these mentions into clusters based on their semantic similarity and clinical meaning. It is better to create more specific, smaller clusters than to group dissimilar items.
            \item For each cluster, provide a concise and descriptive name that captures the core concept (e.g., "Energy Application", "Traction", "Vascular Structures").
        \item Handle synonyms, abbreviations, slight misspellings, and minor variations in phrasing by placing them in the same cluster.
    \end{enumerate}
    
    \textbf{Formatting}
    \begin{itemize}[leftmargin=*,nosep]
    \item Produce a structured list. For each cluster, first state the cluster name, then list all the member mentions.
    \item Do not include explanations or summaries outside of the structured list.
    \end{itemize}
    
    \textbf{Input}
    \begin{itemize}[leftmargin=*,nosep]
    \item \textit{Category} (str): The type of mentions provided (e.g., "Action").
    \item \textit{Mentions} (list of str): The raw textual mentions to be clustered.
    \end{itemize}
    
    \textbf{Output}
    \begin{itemize}[leftmargin=*,nosep]
    \item (str) A formatted string listing each cluster name followed by its members.
    \end{itemize}
    
    {\ttfamily
    Category: \{category\_name\}\\
    Mentions: \{list\_of\_mentions\}\\[2pt]
    Clustered Output:
    }
    \end{tcolorbox}
\end{table*}

\begin{table*}[h!]
    \captionsetup{aboveskip=4pt,belowskip=2pt}
    \small
    \centering
    \caption{\textbf{Prompt for Step 2: Merging fine-grained clusters into functional meta-clusters.}}
    \label{tab:merge_clustering_prompt}
    \begin{tcolorbox}[
    enhanced, 
    width=\textwidth,
    colback=white,
    colframe=black!75!white,
    colbacktitle=black!85!white,
    coltitle=white,
    title=Ontology Induction Prompt (Step 2: Merging into Meta-Clusters),
    fonttitle=\bfseries,
    boxrule=0.4pt,
    arc=0pt, outer arc=0pt,
    left=3pt,right=3pt,top=3pt,bottom=3pt,boxsep=2pt,
    before skip=2pt, after skip=2pt
    ]
    \footnotesize
    
    \textbf{Role.} You are a senior surgical educator and ontology designer refining a clinical label space. Your goal is to merge fine-grained clusters into broader, more practical "meta-clusters" that are functionally relevant for training a machine learning model.
    
    \medskip
    \textbf{Instructions}
    \begin{enumerate}[leftmargin=*,nosep,label=\arabic*.]
        \item You will receive a list of fine-grained clusters, where each cluster has a name and a list of members.
        \item Your task is to merge these fine-grained clusters into a smaller number of high-level meta-clusters based on their shared surgical \textbf{function} or \textbf{purpose}.
        \item For each new meta-cluster, assign a canonical, high-level name that is intuitive and clinically standard (e.g., coagulate, apply\_traction, prostate\_tissue).
        \item Use the provided few-shot examples to guide your merging logic. The goal is to create categories that are distinct and frequent enough for robust classification.
    \end{enumerate}
    
    \textbf{Formatting}
    \begin{itemize}[leftmargin=*,nosep]
    \item Produce a structured list. For each meta-cluster, state its new canonical name, followed by the names of the fine-grained clusters it now contains.
    \item Ensure the output is clean and directly usable as a mapping dictionary.
    \end{itemize}
    
    \textbf{Input}
    \begin{itemize}[leftmargin=*,nosep]
    \item \textit{Fine-Grained Clusters} (str): The structured output from the first clustering step.
    \item \textit{Merge Examples} (str): A few examples showing how to merge related clusters under a new meta-cluster name.
    \end{itemize}
    
    \textbf{Output}
    \begin{itemize}[leftmargin=*,nosep]
    \item (str) A formatted string showing the final meta-cluster mapping.
    \end{itemize}
    
    {\ttfamily
    Fine-Grained Clusters to Merge: \{structured\_list\_from\_step\_1\}\\
    Merge Examples: \{few\_shot\_examples\}\\[2pt]
    Merged Meta-Cluster Output:
    }
    \end{tcolorbox}
\end{table*}



\begin{table*}[t]
  \captionsetup{aboveskip=4pt,belowskip=2pt} % requires \usepackage{caption}
  \small
  \centering
  \caption{\textbf{Prompt for scoring feedback generations and getting clinician-aligned fidelity via LLM-as-Judge.}}
  \label{tab:feedback_eval_prompt}
  \begin{tcolorbox}[
    enhanced, 
    width=\textwidth,
    colback=white,
    colframe=black!75!white,
    colbacktitle=black!85!white,
    coltitle=white,
    title=Generated Feedback Evaluation Prompt,
    fonttitle=\bfseries,
    % boxrule=0.4pt,
    % arc=0pt, outer arc=0pt,
    left=3pt,right=3pt,top=3pt,bottom=3pt,boxsep=2pt,
    before skip=2pt, after skip=2pt
  ]
  \footnotesize

  \textbf{Instruction.} You are a surgical feedback evaluator. 
  
  Your goal is to compare the faithfulness of the generated feedback to the ground truth human expert feedback. Please judge it based only on the core action(s) the trainee is being asked to perform. This includes whether the feedback is a positive or negative (don’t/stop/avoid) instruction — these distinctions are important.

    \medskip
  Score the faithfulness on a scale from 1 to 5, defined as follows:
  
  1 - Opposite or unsafe action: Generated feedback communicates an action that is clearly opposite in intent, or unsafe/conflicting with the ground truth. Includes flipping a negative to a positive (or vice versa) when that changes meaning. (e.g., 'cut the vein' vs 'secure the vein', 'stop' vs 'continue', 'don’t dissect here' vs 'dissect here', 'only one clip' vs 'put all the clips').
  
  2 - Wrong or mismatched action: Generated feedback suggests an action that is different in type or modality from the ground truth. (e.g., 'sweep towards you' vs 'pull the tissue', 'buzz the artery' vs 'clip the artery', 'stop this bleeding' vs 'place a stitch').

    3 - Partially aligned, missing or adding key details: Generated feedback conveys the general action or intent (positive or negative), but omits or adds important details that change the amount, precision, target tissue/instrument, strength or safety of the instruction, or lacks explicit reference to the target action or tissue. (e.g., 'stop the bleed' vs 'buzz that bleeder', 'clip to the artery' vs 'only one clip to artery, wanna be safe', 'come closer' vs 'you can even come 1 mm closer to the prostate', 'do not do it' vs 'don’t do any blunt dissection').

    4 - Mostly aligned, minor wording/emphasis differences: Generated feedback matches the core action and target tissue/instrument, with only minor differences in degree of emphasis, polite hedging, phrasing or verbosity. (e.g., 'cauterize this' vs 'buzz that bleeder', 'closer to prostate' vs 'you can even come 1 mm closer to the prostate', 'clip the artery safely' vs 'only one clip to artery, wanna be safe').

    5 - Perfectly aligned: Generated feedback fully matches the ground truth in core action, target tissue/instrument, intent (positive or negative), and strength of instruction. (e.g., 'coag the vein' vs 'buzz that bleeder', 'stop this bleeding by cauterizing' vs 'buzz that bleeder', 'move the left hand under the ureter' vs 'get L hand below ureter').

    \medskip
    Using this scale, evaluate this generated feedback: "\{gen\_fb\}" against this ground truth feedback: "\{gt\_fb\}". Produce just the number, as your response needs to be processed automatically.

  \end{tcolorbox}
\end{table*}



%%%%%%%%%%%%%%%%%
%%% SECTION 4 %%%
%%%%%%%%%%%%%%%%%
\section{Task1: Video$\rightarrow$IAT Details}
\label{apx:task1_details}

\subsection{Confusion-Matrix Diagnostics for Video$\rightarrow$IAT}
\label{app:cm_iat}

Figure~\ref{fig:cm_iat_combined} shows combined confusion matrices for the
\emph{Instrument}, \emph{Action}, and \emph{Tissue/Target} heads on the validation
set. We observe expected, semantically proximate confusions—e.g., \emph{left\_hand}
vs.\ \emph{fourth\_arm}, energy-related verbs around \emph{coagulate}, and vascular
targets such as \emph{general\_vasculature} vs.\ \emph{major\_veins}—as well as
misclassifications into \emph{None}. These patterns align with the quantitative
gains in Table~\ref{tab:video_iat_auc_gain_results}, where adding clinical context
and temporal instrument tracking improves discrimination, particularly for
instrument and tissue components.


% --- Appendix figure: combined confusion matrices ---
\begin{figure*}[t]
  \centering
  \includegraphics[width=\textwidth,
                   height=0.33\textheight,
                   keepaspectratio]{figures/cm_video_iat_combined.png}
  \vspace{-6pt}
  \caption{\textbf{Video$\rightarrow$IAT confusion matrices (combined).}
  Per-class confusion for the three prediction heads—Instrument, Action, and Tissue/Target—computed on the validation split and visualized side-by-side in a single panel. The plots highlight characteristic confusions (e.g., \emph{left\_hand} vs.\ \emph{fourth\_arm}, energy actions around \emph{coagulate}, and vascular classes such as \emph{general\_vasculature} vs.\ \emph{major\_veins}), as well as the impact of \emph{None} labels. These diagnostics complement the AUC results in Table~\ref{tab:video_iat_auc_gain_results} by illustrating where temporal tracking and clinical context reduce ambiguity.}
  \label{fig:cm_iat_combined}
  \vspace{-6pt}
\end{figure*}


%%%%%%%%%%%%%%%%%
%%% SECTION 5 %%%
%%%%%%%%%%%%%%%%%
\section{Task 2: Feedback Generation Details}
\label{app:task2_details}

\noindent\textbf{Qualitative examples.}
Table~\ref{tab:iat_feedback_examples} illustrates representative cases from \emph{Task 2: Feedback Generation}. For each procedure/task, we list the trainer’s ground-truth feedback, the predicted \emph{Instrument–Action–Tissue (IAT)} triplet used to condition GPT-4o (prompt in App.~\ref{app:gpt4o_fbk_gen_prompt}), the model’s generated message, and the LLM-as-judge \emph{Fidelity} score (1–5). These examples show how triplet grounding steers outputs toward specific, clinically meaningful guidance, and where residual gaps remain.

% Put in preamble or just before the table
\newcommand{\iat}[3]{%
  \begin{tabular}[t]{@{}l@{}}%
  \texttt{inst: #1}\\
  \texttt{act:\ #2}\\
  \texttt{targ:\ #3}%
  \end{tabular}%
}

% Requires: \usepackage{booktabs,tabularx,array}
\begin{table*}[t]
\centering
\small
\setlength{\tabcolsep}{6pt}
\renewcommand{\arraystretch}{1.2}
\begin{tabular}{%
  >{\raggedright\arraybackslash}p{0.16\textwidth}%
  >{\raggedright\arraybackslash}p{0.16\textwidth}%
  >{\raggedright\arraybackslash}p{0.20\textwidth}%
  >{\raggedright\arraybackslash}p{0.30\textwidth}%
  >{\centering\arraybackslash}p{0.05\textwidth}%
}
\toprule
\textbf{Procedure/Task} & \textbf{Ground Truth Feedback} & \textbf{IAT triplet} & \textbf{Generated Feedback} & \textbf{Score} \\
\midrule

%% PERFECT %%
\addlinespace
Radical prostatectomy / Lymph node dissection &
just \textbf{open up}\ldots &
\iat{--}{open}{--} &
Don't hesitate to \textbf{enlarge the incision} here; you won't cause significant issues, so \textbf{ensure you have adequate visibility}. &
5 \\
\addlinespace
Radical prostatectomy / Bladder Neck &
be careful, don't \textbf{rip} the \textbf{prostate} &
\iat{--}{--}{prostate-tissue} &
Be cautious to avoid inadvertently entering the \textbf{prostate tissue}; maintain awareness of surrounding structures. &
5 \\

%% High Quality %%
Simple prostatectomy / Adenoma dissection &
just remember to \textbf{stay right on the surface} of the \textbf{adenoma} &
\iat{--}{stay right}{prostate-tissue} &
Ensure you maintain \textbf{close proximity} to the \textbf{prostate tissue} to facilitate precise dissection and minimize trauma to surrounding structures. &
4 \\
\addlinespace
Partial nephrectomy / Bowel mobilization &
\textbf{lift up} with your \textbf{left hand} more &
\iat{left-hand}{lift}{--} &
Ensure your \textbf{left hand} is positioned to \textbf{provide optimal retraction and exposure}, enhancing visibility and access during bowel mobilization. &
4 \\
\addlinespace
Radical prostatectomy / Lymph node dissection &
so be real careful until you see your \textbf{ureter}, what you're \textbf{buzzing} &
\iat{--}{coagulate}{ureter} &
Avoid \textbf{coagulating} the \textbf{ureter} as it is a critical structure that should be preserved; ensure you correctly identify and protect it. &
4 \\


%% ADMISSIBLE
\addlinespace
Radical Prostatectomy / Dropping Bladder &
grab here, right here. &
\iat{--}{grasp}{--} &
Ensure your \textbf{grasp} is centered and balanced to maintain control and avoid unnecessary tension on the surrounding tissues during bladder mobilization. &
3 \\

\addlinespace
Simple Prostatectomy / Adenoma Dissection &
scrape it off &
\iat{--}{sweeping}{--} &
When performing \textbf{sweeping maneuvers}, ensure you use the side of the instrument effectively to clear loose tissue and define anatomical planes. &
3 \\


%% LOW SCORING
\addlinespace
Simple prostatectomy / Closing Bladder &
No grab closer to the needle. &
\iat{--}{grasp}{needle} &
Ensure you securely \textbf{grasp} the \textbf{needle} at its midpoint to maintain control and precision during suturing, avoiding unnecessary movement that could compromise the bladder closure. &
1 \\
\addlinespace
Radical prostatectomy / Lymph Node Dissection &
wait wait, dont buzz until they paralyze him &
\iat{--}{coagulate}{--} &
Ensure precise application of energy during \textbf{coagulation} to maintain hemostasis without inadvertently affecting surrounding tissues, especially near critical structures. &
1 \\


\bottomrule
\end{tabular}
\caption{Examples of surgeon-aligned feedback generation. For each procedure/task, we show the trainer’s ground-truth feedback, the predicted Instrument–Action–Target (IAT) triplet, the model’s generated feedback, and the alignment score (1–5).}
\label{tab:iat_feedback_examples}
\end{table*}




%%%%%%%%%%%%%%%%%
%%% SECTION 6 %%%
%%%%%%%%%%%%%%%%%
%% Definition and Summaries of Procedures
\section{Procedure Definitions Used for Clinical Context}
\label{app:proc_defs}
To condition the text encoder with situational priors (Sec.~\ref{subsec:clinical_context}), we expanded procedure names into concise, clinically phrased summaries using GPT\mbox{-}4o. Table~\ref{tab:proc_definitions} lists the definitions used during inference.

% \begin{table*}[t]
% \centering
% \small
% \setlength{\tabcolsep}{8pt}
% \renewcommand{\arraystretch}{1.15}
% \begin{tabular}{%
%   >{\raggedright\arraybackslash}p{0.22\textwidth}%
%   >{\raggedright\arraybackslash}p{0.72\textwidth}%
% }
% \toprule
% \textbf{Procedure} & \textbf{Definition (GPT-4o-generated)} \\
% \midrule
% nephrectomy &
% Nephrectomy is a surgical procedure that involves the removal of a kidney. It can be performed as a partial nephrectomy, where only a portion of the kidney is excised, or as a radical nephrectomy, which entails the complete removal of the kidney along with surrounding tissues, including the adrenal gland and nearby lymph nodes. This procedure is typically indicated for conditions such as kidney cancer, severe kidney damage, or donor kidney retrieval. Nephrectomy can be performed using open surgery or minimally invasive techniques, such as laparoscopic surgery, depending on the patient's condition and the surgeon's expertise. \\
% \addlinespace
% nephroureterectomy &
% Nephroureterectomy is a surgical procedure that involves the removal of a kidney (nephrectomy) along with the entire ureter, which is the tube that carries urine from the kidney to the bladder. This procedure is typically performed to treat conditions such as kidney cancer, ureteral cancer, or severe urinary tract infections that do not respond to other treatments. The surgery can be done through an open approach or laparoscopically, depending on the patient's condition and the surgeon's expertise. Postoperative care is essential to monitor for complications and ensure proper recovery. \\
% \addlinespace
% simple prostatectomy &
% A simple prostatectomy is a surgical procedure aimed at removing the prostate gland and some surrounding tissue to alleviate symptoms caused by benign prostatic hyperplasia (BPH) or prostate cancer. This procedure is typically performed through an incision in the lower abdomen or via a transurethral approach, depending on the patient's condition and the surgeon's preference. The goal is to relieve urinary obstruction and improve urinary flow while minimizing complications. Recovery time varies, but patients often experience significant improvement in urinary symptoms post-surgery. \\
% \addlinespace
% radical prostatectomy &
% Radical prostatectomy is a surgical procedure that involves the complete removal of the prostate gland along with some surrounding tissue, including the seminal vesicles and sometimes nearby lymph nodes. This procedure is primarily performed to treat localized prostate cancer and aims to eliminate cancerous cells while preserving as much surrounding healthy tissue as possible. It can be done through open surgery or minimally invasive techniques, such as laparoscopic or robotic-assisted surgery. Postoperative recovery may involve managing urinary incontinence and erectile dysfunction, which are common side effects. \\
% \addlinespace
% partial nephrectomy &
% Partial nephrectomy is a surgical procedure that involves the removal of a portion of a kidney while preserving the remaining healthy tissue. This technique is typically employed to treat localized kidney tumors or lesions, allowing for the excision of cancerous or diseased tissue while maintaining kidney function. The procedure can be performed using open surgery or minimally invasive techniques, such as laparoscopic or robotic-assisted surgery. Postoperative care focuses on monitoring kidney function and managing any potential complications. \\
% \addlinespace
% inguinal hernia repair &
% Inguinal hernia repair is a surgical procedure aimed at correcting an inguinal hernia, which occurs when tissue, often part of the intestine, protrudes through a weak spot in the abdominal muscles in the groin area. The surgery can be performed using an open technique or laparoscopically, where small incisions are made and a camera is used to guide the repair. The surgeon repositions the protruding tissue back into the abdomen and reinforces the abdominal wall, typically using mesh to provide additional support and reduce the risk of recurrence. Postoperative care includes monitoring for complications and managing pain, with most patients able to return to normal activities within a few weeks. \\
% \bottomrule
% \end{tabular}
% \vspace{-8pt}
% \caption{\textbf{Procedure definitions used to provide clinical context.} GPT\mbox{-}4o was prompted to produce concise, clinically oriented summaries for each procedure. These texts were encoded with the same surgery-pretrained video–language backbone used for the video stream (Sec.~\ref{subsec:clinical_context}).}
% \label{tab:proc_definitions}
% \end{table*}

\begin{table*}[t]
\centering
\small
\setlength{\tabcolsep}{8pt}
\renewcommand{\arraystretch}{1.15}
\begin{tabular}{%
    >{\raggedright\arraybackslash}p{0.20\textwidth} 
    >{\raggedright\arraybackslash}p{0.05\textwidth} 
    >{\raggedright\arraybackslash}p{0.72\textwidth} 
}
\toprule
\textbf{Procedure} & \textbf{Count} & \textbf{Definition (GPT-4o-generated)} \\
\midrule
radical prostatectomy & 822 & Radical prostatectomy is a surgical procedure that involves the complete removal of the prostate gland along with some surrounding tissue, including the seminal vesicles and sometimes nearby lymph nodes. This procedure is primarily performed to treat localized prostate cancer and aims to eliminate cancerous cells while preserving as much surrounding healthy tissue as possible. It can be done through open surgery or minimally invasive techniques, such as laparoscopic or robotic-assisted surgery. Postoperative recovery may involve managing urinary incontinence and erectile dysfunction, which are common side effects. \\ 
simple prostatectomy & 279 & A simple prostatectomy is a surgical procedure aimed at removing the prostate gland and some surrounding tissue to alleviate symptoms caused by benign prostatic hyperplasia (BPH) or prostate cancer. This procedure is typically performed through an incision in the lower abdomen or via a transurethral approach, depending on the patient's condition and the surgeon's preference. The goal is to relieve urinary obstruction and improve urinary flow while minimizing complications. Recovery time varies, but patients often experience significant improvement in urinary symptoms post-surgery. \\ 
nephrectomy & 244 & Nephrectomy is a surgical procedure that involves the removal of a kidney. It can be performed as a partial nephrectomy, where only a portion of the kidney is excised, or as a radical nephrectomy, which entails the complete removal of the kidney along with surrounding tissues, including the adrenal gland and nearby lymph nodes. This procedure is typically indicated for conditions such as kidney cancer, severe kidney damage, or donor kidney retrieval. Nephrectomy can be performed using open surgery or minimally invasive techniques, such as laparoscopic surgery, depending on the patient's condition and the surgeon's expertise. \\ 
nephroureterectomy & 67 & Nephroureterectomy is a surgical procedure that involves the removal of a kidney (nephrectomy) along with the entire ureter, which is the tube that carries urine from the kidney to the bladder. This procedure is typically performed to treat conditions such as kidney cancer, ureteral cancer, or severe urinary tract infections that do not respond to other treatments. The surgery can be done through an open approach or laparoscopically, depending on the patient's condition and the surgeon's expertise. Postoperative care is essential to monitor for complications and ensure proper recovery. \\ 
partial nephrectomy & 27 & Partial nephrectomy is a surgical procedure that involves the removal of a portion of a kidney while preserving the remaining healthy tissue. This technique is typically employed to treat localized kidney tumors or lesions, allowing for the excision of cancerous or diseased tissue while maintaining kidney function. The procedure can be performed using open surgery or minimally invasive techniques, such as laparoscopic or robotic-assisted surgery. Postoperative care focuses on monitoring kidney function and managing any potential complications. \\ 
inguinal hernia repair & 11 & Inguinal hernia repair is a surgical procedure aimed at correcting an inguinal hernia, which occurs when tissue, often part of the intestine, protrudes through a weak spot in the abdominal muscles in the groin area. The surgery can be performed using an open technique or laparoscopically, where small incisions are made, and a camera is used to guide the repair. The surgeon repositions the protruding tissue back into the abdomen and reinforces the abdominal wall, typically using mesh to provide additional support and reduce the risk of recurrence. Postoperative care includes monitoring for complications and managing pain, with most patients able to return to normal activities within a few weeks. \\ 
\bottomrule
\end{tabular}
\vspace{-8pt}
\caption{\textbf{Procedure definitions used to provide clinical context.} GPT\mbox{-}4o was prompted to produce concise, clinically oriented summaries for each procedure. These texts were encoded with the same surgery-pretrained video–language backbone used for the video stream (Sec.~\ref{subsec:clinical_context}).}
\label{tab:proc_definitions}
\end{table*}

%% Definition and Summaries Tasks
\section{Task Definitions Used for Clinical Context}
\label{app:task_defs}
To condition the text encoder with situational priors (Sec.~\ref{subsec:clinical_context}), we expanded task names into concise, clinically phrased summaries using GPT\mbox{-}4o. Tables ~\ref{tab:task_definitions_1}, ~\ref{tab:task_definitions_2}, ~\ref{tab:task_definitions_3}, ~\ref{tab:task_definitions_4} lists the definitions used during inference.

\begin{table*}[t]
\centering
\small
\setlength{\tabcolsep}{8pt}
\renewcommand{\arraystretch}{1.15}
\begin{tabular}{%
    >{\raggedright\arraybackslash}p{0.20\textwidth} 
    >{\raggedright\arraybackslash}p{0.05\textwidth} 
    >{\raggedright\arraybackslash}p{0.72\textwidth} 
}
\toprule
\textbf{Local Task} & \textbf{Count} & \textbf{Definition (GPT-4o-generated)} \\
\midrule
Bladder Neck & 123 & The bladder neck is the region where the bladder connects to the urethra, and during surgical teaching, it is crucial to demonstrate the anatomy and function of this area, emphasizing its role in urinary continence and the potential complications that can arise from surgical manipulation, such as in prostatectomy procedures. Instruct trainees on identifying the bladder neck's landmarks and techniques for preserving its integrity during surgery to minimize postoperative complications. \\
SV & 54 & In urology surgery, the teaching step "SV" refers to "Surgical Visualization," which emphasizes the importance of clear and effective visualization of the surgical field through proper positioning, retraction, and use of appropriate lighting and magnification techniques to enhance the surgeon's ability to identify anatomical structures and perform precise interventions. \\
Posterior Plane & 6 & The posterior plane refers to the anatomical space located behind the bladder and prostate, which is critical for accessing the pelvic structures during urological surgeries. In teaching this step, emphasize the importance of identifying and carefully dissecting the posterior plane to avoid injury to surrounding nerves and vessels while facilitating access to the surgical site. \\
Pedicle/NVB & 24 & The Pedicle/Nerve Vascular Bundle (NVB) step involves careful identification and preservation of the neurovascular structures during urological surgery, particularly in procedures like prostatectomy, to minimize the risk of nerve damage and maintain erectile function. Surgeons should be trained to meticulously dissect around these structures, using appropriate techniques to ensure their integrity while achieving the surgical goals. \\
Apical Dissection & 10 & Apical dissection involves carefully separating the tissue at the apex of the prostate to access the surrounding structures while preserving critical neurovascular bundles. This step is crucial for minimizing complications and ensuring adequate oncological control during prostatectomy procedures. \\
DVC & 7 & DVC, or "Dorsal Venous Complex," refers to the anatomical structure that is critical in urological surgeries, particularly during penile procedures. Teaching this step involves instructing trainees on the identification and management of the DVC to prevent excessive bleeding and ensure proper surgical technique during operations such as circumcision or penile reconstruction. \\
Oblique Checks & 8 & Oblique checks involve assessing the orientation and positioning of the surgical instruments and anatomical structures during a urological procedure to ensure proper alignment and access. This step is crucial for minimizing complications and optimizing the surgical approach. \\
VUA & 154 & Vesicourethral anastomosis (VUA) is the surgical step where the bladder is reconnected to the urethra after prostatectomy or bladder surgery, ensuring proper alignment and tension-free suturing to facilitate optimal healing and urinary function. This step typically involves careful dissection, identification of anatomical landmarks, and the use of absorbable sutures to secure the anastomosis. \\
Adenoma Dissection & 115 & Adenoma dissection involves carefully identifying and separating the adenomatous tissue from surrounding structures using precise surgical techniques, ensuring minimal trauma to adjacent healthy tissue. This step is crucial for achieving complete resection while preserving functional anatomy and reducing the risk of complications. \\
Lymph Node Dissection & 197 & Lymph node dissection involves the surgical removal of lymph nodes to assess for cancer spread, typically performed in conjunction with other procedures such as radical prostatectomy or cystectomy. The teaching step includes identifying the anatomical landmarks, ensuring proper technique to minimize complications, and understanding the implications of lymphatic drainage in urological malignancies. \\
% Dropping Bladder & 104 & Dropping the bladder involves carefully mobilizing the bladder from its anatomical attachments to the pelvic structures, ensuring that the surrounding tissues are preserved while providing adequate exposure for the surgical procedure. This step is crucial for accessing the underlying structures and minimizing the risk of injury during surgery. \\
% Endopelvic Fascia & 32 & The endopelvic fascia is a connective tissue layer that supports pelvic organs and is crucial in urological surgeries. During teaching, emphasize its anatomical significance, the importance of preserving it to maintain pelvic support, and techniques for identifying and dissecting it safely to avoid complications. \\
% Pedicles/NVB/Apical Dissection & 5 & During the pedicles, neurovascular bundles (NVB), and apical dissection step, the surgeon carefully identifies and preserves the neurovascular structures while mobilizing the prostate and surrounding tissues. This involves meticulous dissection to minimize damage to the nerves and blood vessels, ensuring optimal functional outcomes post-surgery. \\
% Bowel Mobilization & 131 & Bowel mobilization involves carefully dissecting and freeing the bowel from surrounding structures to create a clear surgical field, ensuring that the bowel can be safely retracted or manipulated without compromising its blood supply or function. This step is crucial for accessing the surgical site and minimizing the risk of postoperative complications. \\
% Dissection & 181 & Dissection involves carefully separating and isolating anatomical structures using surgical instruments, ensuring minimal trauma to surrounding tissues while providing clear access to the target area for further surgical intervention. This step requires a thorough understanding of anatomy and meticulous technique to avoid complications. \\
% Stapling Ureter & 1 & The teaching step for stapling the ureter involves carefully aligning the ureteral edges to ensure proper tension and orientation, followed by the application of a surgical stapler to create a secure and watertight anastomosis. It is crucial to assess the integrity of the staple line and ensure there are no obstructions or kinks in the ureter post-stapling. \\
% Bagging Specimen & 4 & Bagging the specimen involves carefully placing the excised tissue or organ into a sterile bag to prevent contamination and facilitate safe handling during transport to pathology. This step is crucial for maintaining specimen integrity and ensuring accurate diagnostic evaluation. \\
% Cystotomy & 17 & Cystotomy is the surgical procedure involving an incision into the bladder to access its interior, typically performed to remove bladder stones, tumors, or to facilitate other surgical interventions. During teaching, emphasize the importance of proper incision technique, maintaining hemostasis, and ensuring bladder integrity to prevent complications. \\
% Closing Bladder & 112 & Closing the bladder involves carefully suturing the bladder wall using absorbable sutures in a continuous or interrupted fashion, ensuring proper alignment of the tissue layers to prevent leakage and promote healing. It is essential to maintain hemostasis and avoid tension on the sutures to minimize complications. \\
% Hemostasis/Bladder Neck & 1 & In the hemostasis step at the bladder neck, the surgeon meticulously identifies and controls any bleeding vessels using techniques such as cauterization or ligation, ensuring a clear surgical field and minimizing the risk of postoperative complications. This step is crucial for maintaining hemostatic balance and facilitating a safe and effective surgical procedure. \\
% DVC, Hemostasis, Rocco Stitch & 5 & DVC (Dorsal Venous Complex) management involves careful identification and control of the dorsal venous complex to minimize bleeding during prostatectomy. Hemostasis is achieved by meticulously ligating or cauterizing blood vessels to prevent excessive blood loss, while the Rocco stitch is a surgical technique used to reinforce the posterior urethral support by suturing the bladder neck to the pelvic floor, enhancing continence postoperatively. \\
% DVC, Hemostasis & 1 & DVC (Dorsal Venous Complex) hemostasis involves identifying and controlling the dorsal venous complex during urological procedures, typically by clamping, ligating, or cauterizing the vessels to prevent excessive bleeding. This step is crucial for maintaining a clear surgical field and ensuring patient safety throughout the operation. \\
% Bladder Neck (Trigonization?) & 7 & Bladder neck trigonization involves the surgical technique of reshaping or reconstructing the bladder neck to improve urinary function, often performed during procedures for conditions like bladder outlet obstruction or incontinence. The teaching step emphasizes the importance of identifying anatomical landmarks, ensuring proper tension on the bladder neck, and achieving a secure closure to maintain urinary continence postoperatively. \\
% Tumor Dissection & 1 & Tumor dissection involves carefully separating the tumor from surrounding tissues and structures while preserving critical anatomical landmarks and minimizing damage to adjacent organs. This step requires meticulous technique to ensure complete tumor removal and to reduce the risk of recurrence or complications. \\
% Suturing Kidney & 1 & When suturing the kidney, begin by selecting an appropriate suture material and needle, then carefully approximate the renal tissue edges using a continuous or interrupted technique, ensuring to avoid excessive tension to preserve blood supply and function. Finally, secure the sutures with adequate knots, ensuring hemostasis and proper alignment of the renal parenchyma. \\
% Peritoneal Flap and Mesh Pocket Dissection & 11 & Peritoneal flap and mesh pocket dissection involves carefully mobilizing the peritoneum to create a flap that can be used to cover a surgical site, while simultaneously dissecting a pocket for the placement of mesh. This step requires meticulous attention to avoid injury to surrounding structures and ensure adequate space for secure mesh placement, promoting optimal healing and minimizing complications. \\
% Anchoring of Mesh & 4 & Anchoring of mesh involves securely attaching the surgical mesh to the surrounding tissue to provide support and prevent migration, typically using sutures or fixation devices. This step is crucial for ensuring the stability and effectiveness of the mesh in reinforcing the pelvic floor or repairing hernias. \\
% Closing Peritoneum & 12 & Closing the peritoneum involves carefully approximating the edges of the peritoneal layer using absorbable sutures, ensuring that the tissue is aligned properly to promote healing and minimize the risk of adhesions. It is important to maintain a tension-free closure while avoiding excessive manipulation of surrounding structures. \\
% Bladder Closure & 7 & Bladder closure involves meticulously suturing the bladder wall to ensure a secure and watertight seal, typically using absorbable sutures in a continuous or interrupted fashion, while carefully avoiding tension on the tissue to promote optimal healing and prevent complications such as leakage or stricture. It is essential to assess the integrity of the closure before concluding the procedure, often by performing a saline test to check for any leaks. \\
% SVs & 50 & SVs, or surgical videos, are utilized as a teaching step to provide visual demonstrations of surgical techniques and procedures. They serve as an educational tool to enhance understanding of anatomy, instrumentation, and surgical maneuvers, allowing trainees to visualize complex steps before performing them in the operating room. \\
% SV/Vas & 20 & The SV/Vas teaching step involves the identification and dissection of the seminal vesicles (SV) and vas deferens (Vas) during urological surgery, ensuring careful preservation of surrounding structures while facilitating access for procedures such as vasectomy or prostatectomy. This step emphasizes the importance of anatomical landmarks and the technique of blunt and sharp dissection to minimize complications. \\
% Bladder Neck (Suture) & 4 & The bladder neck suture step involves placing sutures at the bladder neck to provide support and maintain proper anatomical alignment, which is crucial for preventing postoperative complications such as urinary incontinence. This step requires careful technique to ensure the sutures are secure yet not overly tight, allowing for normal bladder function. \\
% NVB & 7 & NVB, or Neurovascular Bundle, refers to the critical anatomical structures that include nerves and blood vessels surrounding the prostate. In surgical teaching, it is essential to identify and preserve the NVB during prostatectomy to maintain erectile function and minimize complications, emphasizing careful dissection and awareness of anatomical landmarks. \\
% Pexy & 7 & Pexy refers to the surgical technique of anchoring or securing an organ or tissue to another structure, often used in procedures like cystopexy or nephropexy to stabilize the bladder or kidney, respectively. In teaching this step, emphasize the importance of proper anatomical identification, tension management, and the choice of suturing technique to ensure effective stabilization while minimizing complications. \\
% Defatting Prostate & 2 & Defatting the prostate involves carefully removing excess adipose tissue surrounding the prostate gland to enhance visibility and access during surgery. This step is crucial for minimizing bleeding and facilitating the subsequent surgical procedures, such as prostatectomy or other interventions. \\
% Leak Testing, etc & 2 & Leak testing involves filling the surgical site or reconstructed structure with a fluid (usually saline) to assess for any leaks or defects in the anastomosis or closure. This step is crucial to ensure the integrity of the surgical repair before finalizing the procedure, as it helps identify potential complications that could lead to postoperative issues. \\
\bottomrule
\end{tabular}
\vspace{-8pt}
\caption{\textbf{(1) Local task definitions used to provide clinical context alongside the procedure.} GPT\mbox{-}4o was prompted to produce concise, clinically oriented summaries for each procedure. These texts were encoded with the same surgery-pretrained video–language backbone used for the video stream (Sec.~\ref{subsec:clinical_context}).}
\label{tab:task_definitions_1}
\end{table*}


\begin{table*}[t]
\centering
\small
\setlength{\tabcolsep}{8pt}
\renewcommand{\arraystretch}{1.15}
\begin{tabular}{%
    >{\raggedright\arraybackslash}p{0.20\textwidth} 
    >{\raggedright\arraybackslash}p{0.05\textwidth} 
    >{\raggedright\arraybackslash}p{0.72\textwidth} 
}
\toprule
\textbf{Local Task} & \textbf{Count} & \textbf{Definition (GPT-4o-generated)} \\
\midrule
% Bladder Neck & 123 & The bladder neck is the region where the bladder connects to the urethra, and during surgical teaching, it is crucial to demonstrate the anatomy and function of this area, emphasizing its role in urinary continence and the potential complications that can arise from surgical manipulation, such as in prostatectomy procedures. Instruct trainees on identifying the bladder neck's landmarks and techniques for preserving its integrity during surgery to minimize postoperative complications. \\
% SV & 54 & In urology surgery, the teaching step "SV" refers to "Surgical Visualization," which emphasizes the importance of clear and effective visualization of the surgical field through proper positioning, retraction, and use of appropriate lighting and magnification techniques to enhance the surgeon's ability to identify anatomical structures and perform precise interventions. \\
% Posterior Plane & 6 & The posterior plane refers to the anatomical space located behind the bladder and prostate, which is critical for accessing the pelvic structures during urological surgeries. In teaching this step, emphasize the importance of identifying and carefully dissecting the posterior plane to avoid injury to surrounding nerves and vessels while facilitating access to the surgical site. \\
% Pedicle/NVB & 24 & The Pedicle/Nerve Vascular Bundle (NVB) step involves careful identification and preservation of the neurovascular structures during urological surgery, particularly in procedures like prostatectomy, to minimize the risk of nerve damage and maintain erectile function. Surgeons should be trained to meticulously dissect around these structures, using appropriate techniques to ensure their integrity while achieving the surgical goals. \\
% Apical Dissection & 10 & Apical dissection involves carefully separating the tissue at the apex of the prostate to access the surrounding structures while preserving critical neurovascular bundles. This step is crucial for minimizing complications and ensuring adequate oncological control during prostatectomy procedures. \\
% DVC & 7 & DVC, or "Dorsal Venous Complex," refers to the anatomical structure that is critical in urological surgeries, particularly during penile procedures. Teaching this step involves instructing trainees on the identification and management of the DVC to prevent excessive bleeding and ensure proper surgical technique during operations such as circumcision or penile reconstruction. \\
% Oblique Checks & 8 & Oblique checks involve assessing the orientation and positioning of the surgical instruments and anatomical structures during a urological procedure to ensure proper alignment and access. This step is crucial for minimizing complications and optimizing the surgical approach. \\
% VUA & 154 & Vesicourethral anastomosis (VUA) is the surgical step where the bladder is reconnected to the urethra after prostatectomy or bladder surgery, ensuring proper alignment and tension-free suturing to facilitate optimal healing and urinary function. This step typically involves careful dissection, identification of anatomical landmarks, and the use of absorbable sutures to secure the anastomosis. \\
% Adenoma Dissection & 115 & Adenoma dissection involves carefully identifying and separating the adenomatous tissue from surrounding structures using precise surgical techniques, ensuring minimal trauma to adjacent healthy tissue. This step is crucial for achieving complete resection while preserving functional anatomy and reducing the risk of complications. \\
% Lymph Node Dissection & 197 & Lymph node dissection involves the surgical removal of lymph nodes to assess for cancer spread, typically performed in conjunction with other procedures such as radical prostatectomy or cystectomy. The teaching step includes identifying the anatomical landmarks, ensuring proper technique to minimize complications, and understanding the implications of lymphatic drainage in urological malignancies. \\
Dropping Bladder & 104 & Dropping the bladder involves carefully mobilizing the bladder from its anatomical attachments to the pelvic structures, ensuring that the surrounding tissues are preserved while providing adequate exposure for the surgical procedure. This step is crucial for accessing the underlying structures and minimizing the risk of injury during surgery. \\
Endopelvic Fascia & 32 & The endopelvic fascia is a connective tissue layer that supports pelvic organs and is crucial in urological surgeries. During teaching, emphasize its anatomical significance, the importance of preserving it to maintain pelvic support, and techniques for identifying and dissecting it safely to avoid complications. \\
Pedicles/NVB/Apical Dissection & 5 & During the pedicles, neurovascular bundles (NVB), and apical dissection step, the surgeon carefully identifies and preserves the neurovascular structures while mobilizing the prostate and surrounding tissues. This involves meticulous dissection to minimize damage to the nerves and blood vessels, ensuring optimal functional outcomes post-surgery. \\
Bowel Mobilization & 131 & Bowel mobilization involves carefully dissecting and freeing the bowel from surrounding structures to create a clear surgical field, ensuring that the bowel can be safely retracted or manipulated without compromising its blood supply or function. This step is crucial for accessing the surgical site and minimizing the risk of postoperative complications. \\
Dissection & 181 & Dissection involves carefully separating and isolating anatomical structures using surgical instruments, ensuring minimal trauma to surrounding tissues while providing clear access to the target area for further surgical intervention. This step requires a thorough understanding of anatomy and meticulous technique to avoid complications. \\
Stapling Ureter & 1 & The teaching step for stapling the ureter involves carefully aligning the ureteral edges to ensure proper tension and orientation, followed by the application of a surgical stapler to create a secure and watertight anastomosis. It is crucial to assess the integrity of the staple line and ensure there are no obstructions or kinks in the ureter post-stapling. \\
Bagging Specimen & 4 & Bagging the specimen involves carefully placing the excised tissue or organ into a sterile bag to prevent contamination and facilitate safe handling during transport to pathology. This step is crucial for maintaining specimen integrity and ensuring accurate diagnostic evaluation. \\
Cystotomy & 17 & Cystotomy is the surgical procedure involving an incision into the bladder to access its interior, typically performed to remove bladder stones, tumors, or to facilitate other surgical interventions. During teaching, emphasize the importance of proper incision technique, maintaining hemostasis, and ensuring bladder integrity to prevent complications. \\
Closing Bladder & 112 & Closing the bladder involves carefully suturing the bladder wall using absorbable sutures in a continuous or interrupted fashion, ensuring proper alignment of the tissue layers to prevent leakage and promote healing. It is essential to maintain hemostasis and avoid tension on the sutures to minimize complications. \\
Hemostasis/Bladder Neck & 1 & In the hemostasis step at the bladder neck, the surgeon meticulously identifies and controls any bleeding vessels using techniques such as cauterization or ligation, ensuring a clear surgical field and minimizing the risk of postoperative complications. This step is crucial for maintaining hemostatic balance and facilitating a safe and effective surgical procedure. \\
% DVC, Hemostasis, Rocco Stitch & 5 & DVC (Dorsal Venous Complex) management involves careful identification and control of the dorsal venous complex to minimize bleeding during prostatectomy. Hemostasis is achieved by meticulously ligating or cauterizing blood vessels to prevent excessive blood loss, while the Rocco stitch is a surgical technique used to reinforce the posterior urethral support by suturing the bladder neck to the pelvic floor, enhancing continence postoperatively. \\
% DVC, Hemostasis & 1 & DVC (Dorsal Venous Complex) hemostasis involves identifying and controlling the dorsal venous complex during urological procedures, typically by clamping, ligating, or cauterizing the vessels to prevent excessive bleeding. This step is crucial for maintaining a clear surgical field and ensuring patient safety throughout the operation. \\
% Bladder Neck (Trigonization?) & 7 & Bladder neck trigonization involves the surgical technique of reshaping or reconstructing the bladder neck to improve urinary function, often performed during procedures for conditions like bladder outlet obstruction or incontinence. The teaching step emphasizes the importance of identifying anatomical landmarks, ensuring proper tension on the bladder neck, and achieving a secure closure to maintain urinary continence postoperatively. \\
% Tumor Dissection & 1 & Tumor dissection involves carefully separating the tumor from surrounding tissues and structures while preserving critical anatomical landmarks and minimizing damage to adjacent organs. This step requires meticulous technique to ensure complete tumor removal and to reduce the risk of recurrence or complications. \\
% Suturing Kidney & 1 & When suturing the kidney, begin by selecting an appropriate suture material and needle, then carefully approximate the renal tissue edges using a continuous or interrupted technique, ensuring to avoid excessive tension to preserve blood supply and function. Finally, secure the sutures with adequate knots, ensuring hemostasis and proper alignment of the renal parenchyma. \\
% Peritoneal Flap and Mesh Pocket Dissection & 11 & Peritoneal flap and mesh pocket dissection involves carefully mobilizing the peritoneum to create a flap that can be used to cover a surgical site, while simultaneously dissecting a pocket for the placement of mesh. This step requires meticulous attention to avoid injury to surrounding structures and ensure adequate space for secure mesh placement, promoting optimal healing and minimizing complications. \\
% Anchoring of Mesh & 4 & Anchoring of mesh involves securely attaching the surgical mesh to the surrounding tissue to provide support and prevent migration, typically using sutures or fixation devices. This step is crucial for ensuring the stability and effectiveness of the mesh in reinforcing the pelvic floor or repairing hernias. \\
% Closing Peritoneum & 12 & Closing the peritoneum involves carefully approximating the edges of the peritoneal layer using absorbable sutures, ensuring that the tissue is aligned properly to promote healing and minimize the risk of adhesions. It is important to maintain a tension-free closure while avoiding excessive manipulation of surrounding structures. \\
% Bladder Closure & 7 & Bladder closure involves meticulously suturing the bladder wall to ensure a secure and watertight seal, typically using absorbable sutures in a continuous or interrupted fashion, while carefully avoiding tension on the tissue to promote optimal healing and prevent complications such as leakage or stricture. It is essential to assess the integrity of the closure before concluding the procedure, often by performing a saline test to check for any leaks. \\
% SVs & 50 & SVs, or surgical videos, are utilized as a teaching step to provide visual demonstrations of surgical techniques and procedures. They serve as an educational tool to enhance understanding of anatomy, instrumentation, and surgical maneuvers, allowing trainees to visualize complex steps before performing them in the operating room. \\
% SV/Vas & 20 & The SV/Vas teaching step involves the identification and dissection of the seminal vesicles (SV) and vas deferens (Vas) during urological surgery, ensuring careful preservation of surrounding structures while facilitating access for procedures such as vasectomy or prostatectomy. This step emphasizes the importance of anatomical landmarks and the technique of blunt and sharp dissection to minimize complications. \\
% Bladder Neck (Suture) & 4 & The bladder neck suture step involves placing sutures at the bladder neck to provide support and maintain proper anatomical alignment, which is crucial for preventing postoperative complications such as urinary incontinence. This step requires careful technique to ensure the sutures are secure yet not overly tight, allowing for normal bladder function. \\
% NVB & 7 & NVB, or Neurovascular Bundle, refers to the critical anatomical structures that include nerves and blood vessels surrounding the prostate. In surgical teaching, it is essential to identify and preserve the NVB during prostatectomy to maintain erectile function and minimize complications, emphasizing careful dissection and awareness of anatomical landmarks. \\
% Pexy & 7 & Pexy refers to the surgical technique of anchoring or securing an organ or tissue to another structure, often used in procedures like cystopexy or nephropexy to stabilize the bladder or kidney, respectively. In teaching this step, emphasize the importance of proper anatomical identification, tension management, and the choice of suturing technique to ensure effective stabilization while minimizing complications. \\
% Defatting Prostate & 2 & Defatting the prostate involves carefully removing excess adipose tissue surrounding the prostate gland to enhance visibility and access during surgery. This step is crucial for minimizing bleeding and facilitating the subsequent surgical procedures, such as prostatectomy or other interventions. \\
% Leak Testing, etc & 2 & Leak testing involves filling the surgical site or reconstructed structure with a fluid (usually saline) to assess for any leaks or defects in the anastomosis or closure. This step is crucial to ensure the integrity of the surgical repair before finalizing the procedure, as it helps identify potential complications that could lead to postoperative issues. \\
\bottomrule
\end{tabular}
\vspace{-8pt}
\caption{\textbf{(2) Local task definitions used to provide clinical context alongside the procedure.} GPT\mbox{-}4o was prompted to produce concise, clinically oriented summaries for each procedure. These texts were encoded with the same surgery-pretrained video–language backbone used for the video stream (Sec.~\ref{subsec:clinical_context}).}
\label{tab:task_definitions_2}
\end{table*}

\begin{table*}[t]
\centering
\small
\setlength{\tabcolsep}{8pt}
\renewcommand{\arraystretch}{1.15}
\begin{tabular}{%
    >{\raggedright\arraybackslash}p{0.20\textwidth} 
    >{\raggedright\arraybackslash}p{0.05\textwidth} 
    >{\raggedright\arraybackslash}p{0.72\textwidth} 
}
\toprule
\textbf{Local Task} & \textbf{Count} & \textbf{Definition (GPT-4o-generated)} \\
\midrule
% Bladder Neck & 123 & The bladder neck is the region where the bladder connects to the urethra, and during surgical teaching, it is crucial to demonstrate the anatomy and function of this area, emphasizing its role in urinary continence and the potential complications that can arise from surgical manipulation, such as in prostatectomy procedures. Instruct trainees on identifying the bladder neck's landmarks and techniques for preserving its integrity during surgery to minimize postoperative complications. \\
% SV & 54 & In urology surgery, the teaching step "SV" refers to "Surgical Visualization," which emphasizes the importance of clear and effective visualization of the surgical field through proper positioning, retraction, and use of appropriate lighting and magnification techniques to enhance the surgeon's ability to identify anatomical structures and perform precise interventions. \\
% Posterior Plane & 6 & The posterior plane refers to the anatomical space located behind the bladder and prostate, which is critical for accessing the pelvic structures during urological surgeries. In teaching this step, emphasize the importance of identifying and carefully dissecting the posterior plane to avoid injury to surrounding nerves and vessels while facilitating access to the surgical site. \\
% Pedicle/NVB & 24 & The Pedicle/Nerve Vascular Bundle (NVB) step involves careful identification and preservation of the neurovascular structures during urological surgery, particularly in procedures like prostatectomy, to minimize the risk of nerve damage and maintain erectile function. Surgeons should be trained to meticulously dissect around these structures, using appropriate techniques to ensure their integrity while achieving the surgical goals. \\
% Apical Dissection & 10 & Apical dissection involves carefully separating the tissue at the apex of the prostate to access the surrounding structures while preserving critical neurovascular bundles. This step is crucial for minimizing complications and ensuring adequate oncological control during prostatectomy procedures. \\
% DVC & 7 & DVC, or "Dorsal Venous Complex," refers to the anatomical structure that is critical in urological surgeries, particularly during penile procedures. Teaching this step involves instructing trainees on the identification and management of the DVC to prevent excessive bleeding and ensure proper surgical technique during operations such as circumcision or penile reconstruction. \\
% Oblique Checks & 8 & Oblique checks involve assessing the orientation and positioning of the surgical instruments and anatomical structures during a urological procedure to ensure proper alignment and access. This step is crucial for minimizing complications and optimizing the surgical approach. \\
% VUA & 154 & Vesicourethral anastomosis (VUA) is the surgical step where the bladder is reconnected to the urethra after prostatectomy or bladder surgery, ensuring proper alignment and tension-free suturing to facilitate optimal healing and urinary function. This step typically involves careful dissection, identification of anatomical landmarks, and the use of absorbable sutures to secure the anastomosis. \\
% Adenoma Dissection & 115 & Adenoma dissection involves carefully identifying and separating the adenomatous tissue from surrounding structures using precise surgical techniques, ensuring minimal trauma to adjacent healthy tissue. This step is crucial for achieving complete resection while preserving functional anatomy and reducing the risk of complications. \\
% Lymph Node Dissection & 197 & Lymph node dissection involves the surgical removal of lymph nodes to assess for cancer spread, typically performed in conjunction with other procedures such as radical prostatectomy or cystectomy. The teaching step includes identifying the anatomical landmarks, ensuring proper technique to minimize complications, and understanding the implications of lymphatic drainage in urological malignancies. \\
% Dropping Bladder & 104 & Dropping the bladder involves carefully mobilizing the bladder from its anatomical attachments to the pelvic structures, ensuring that the surrounding tissues are preserved while providing adequate exposure for the surgical procedure. This step is crucial for accessing the underlying structures and minimizing the risk of injury during surgery. \\
% Endopelvic Fascia & 32 & The endopelvic fascia is a connective tissue layer that supports pelvic organs and is crucial in urological surgeries. During teaching, emphasize its anatomical significance, the importance of preserving it to maintain pelvic support, and techniques for identifying and dissecting it safely to avoid complications. \\
% Pedicles/NVB/Apical Dissection & 5 & During the pedicles, neurovascular bundles (NVB), and apical dissection step, the surgeon carefully identifies and preserves the neurovascular structures while mobilizing the prostate and surrounding tissues. This involves meticulous dissection to minimize damage to the nerves and blood vessels, ensuring optimal functional outcomes post-surgery. \\
% Bowel Mobilization & 131 & Bowel mobilization involves carefully dissecting and freeing the bowel from surrounding structures to create a clear surgical field, ensuring that the bowel can be safely retracted or manipulated without compromising its blood supply or function. This step is crucial for accessing the surgical site and minimizing the risk of postoperative complications. \\
% Dissection & 181 & Dissection involves carefully separating and isolating anatomical structures using surgical instruments, ensuring minimal trauma to surrounding tissues while providing clear access to the target area for further surgical intervention. This step requires a thorough understanding of anatomy and meticulous technique to avoid complications. \\
% Stapling Ureter & 1 & The teaching step for stapling the ureter involves carefully aligning the ureteral edges to ensure proper tension and orientation, followed by the application of a surgical stapler to create a secure and watertight anastomosis. It is crucial to assess the integrity of the staple line and ensure there are no obstructions or kinks in the ureter post-stapling. \\
% Bagging Specimen & 4 & Bagging the specimen involves carefully placing the excised tissue or organ into a sterile bag to prevent contamination and facilitate safe handling during transport to pathology. This step is crucial for maintaining specimen integrity and ensuring accurate diagnostic evaluation. \\
% Cystotomy & 17 & Cystotomy is the surgical procedure involving an incision into the bladder to access its interior, typically performed to remove bladder stones, tumors, or to facilitate other surgical interventions. During teaching, emphasize the importance of proper incision technique, maintaining hemostasis, and ensuring bladder integrity to prevent complications. \\
% Closing Bladder & 112 & Closing the bladder involves carefully suturing the bladder wall using absorbable sutures in a continuous or interrupted fashion, ensuring proper alignment of the tissue layers to prevent leakage and promote healing. It is essential to maintain hemostasis and avoid tension on the sutures to minimize complications. \\
% Hemostasis/Bladder Neck & 1 & In the hemostasis step at the bladder neck, the surgeon meticulously identifies and controls any bleeding vessels using techniques such as cauterization or ligation, ensuring a clear surgical field and minimizing the risk of postoperative complications. This step is crucial for maintaining hemostatic balance and facilitating a safe and effective surgical procedure. \\
DVC, Hemostasis, Rocco Stitch & 5 & DVC (Dorsal Venous Complex) management involves careful identification and control of the dorsal venous complex to minimize bleeding during prostatectomy. Hemostasis is achieved by meticulously ligating or cauterizing blood vessels to prevent excessive blood loss, while the Rocco stitch is a surgical technique used to reinforce the posterior urethral support by suturing the bladder neck to the pelvic floor, enhancing continence postoperatively. \\
DVC, Hemostasis & 1 & DVC (Dorsal Venous Complex) hemostasis involves identifying and controlling the dorsal venous complex during urological procedures, typically by clamping, ligating, or cauterizing the vessels to prevent excessive bleeding. This step is crucial for maintaining a clear surgical field and ensuring patient safety throughout the operation. \\
Bladder Neck (Trigonization?) & 7 & Bladder neck trigonization involves the surgical technique of reshaping or reconstructing the bladder neck to improve urinary function, often performed during procedures for conditions like bladder outlet obstruction or incontinence. The teaching step emphasizes the importance of identifying anatomical landmarks, ensuring proper tension on the bladder neck, and achieving a secure closure to maintain urinary continence postoperatively. \\
Tumor Dissection & 1 & Tumor dissection involves carefully separating the tumor from surrounding tissues and structures while preserving critical anatomical landmarks and minimizing damage to adjacent organs. This step requires meticulous technique to ensure complete tumor removal and to reduce the risk of recurrence or complications. \\
Suturing Kidney & 1 & When suturing the kidney, begin by selecting an appropriate suture material and needle, then carefully approximate the renal tissue edges using a continuous or interrupted technique, ensuring to avoid excessive tension to preserve blood supply and function. Finally, secure the sutures with adequate knots, ensuring hemostasis and proper alignment of the renal parenchyma. \\
Peritoneal Flap and Mesh Pocket Dissection & 11 & Peritoneal flap and mesh pocket dissection involves carefully mobilizing the peritoneum to create a flap that can be used to cover a surgical site, while simultaneously dissecting a pocket for the placement of mesh. This step requires meticulous attention to avoid injury to surrounding structures and ensure adequate space for secure mesh placement, promoting optimal healing and minimizing complications. \\
Anchoring of Mesh & 4 & Anchoring of mesh involves securely attaching the surgical mesh to the surrounding tissue to provide support and prevent migration, typically using sutures or fixation devices. This step is crucial for ensuring the stability and effectiveness of the mesh in reinforcing the pelvic floor or repairing hernias. \\
Closing Peritoneum & 12 & Closing the peritoneum involves carefully approximating the edges of the peritoneal layer using absorbable sutures, ensuring that the tissue is aligned properly to promote healing and minimize the risk of adhesions. It is important to maintain a tension-free closure while avoiding excessive manipulation of surrounding structures. \\
Bladder Closure & 7 & Bladder closure involves meticulously suturing the bladder wall to ensure a secure and watertight seal, typically using absorbable sutures in a continuous or interrupted fashion, while carefully avoiding tension on the tissue to promote optimal healing and prevent complications such as leakage or stricture. It is essential to assess the integrity of the closure before concluding the procedure, often by performing a saline test to check for any leaks. \\
% SVs & 50 & SVs, or surgical videos, are utilized as a teaching step to provide visual demonstrations of surgical techniques and procedures. They serve as an educational tool to enhance understanding of anatomy, instrumentation, and surgical maneuvers, allowing trainees to visualize complex steps before performing them in the operating room. \\
% SV/Vas & 20 & The SV/Vas teaching step involves the identification and dissection of the seminal vesicles (SV) and vas deferens (Vas) during urological surgery, ensuring careful preservation of surrounding structures while facilitating access for procedures such as vasectomy or prostatectomy. This step emphasizes the importance of anatomical landmarks and the technique of blunt and sharp dissection to minimize complications. \\
% Bladder Neck (Suture) & 4 & The bladder neck suture step involves placing sutures at the bladder neck to provide support and maintain proper anatomical alignment, which is crucial for preventing postoperative complications such as urinary incontinence. This step requires careful technique to ensure the sutures are secure yet not overly tight, allowing for normal bladder function. \\
% NVB & 7 & NVB, or Neurovascular Bundle, refers to the critical anatomical structures that include nerves and blood vessels surrounding the prostate. In surgical teaching, it is essential to identify and preserve the NVB during prostatectomy to maintain erectile function and minimize complications, emphasizing careful dissection and awareness of anatomical landmarks. \\
% Pexy & 7 & Pexy refers to the surgical technique of anchoring or securing an organ or tissue to another structure, often used in procedures like cystopexy or nephropexy to stabilize the bladder or kidney, respectively. In teaching this step, emphasize the importance of proper anatomical identification, tension management, and the choice of suturing technique to ensure effective stabilization while minimizing complications. \\
% Defatting Prostate & 2 & Defatting the prostate involves carefully removing excess adipose tissue surrounding the prostate gland to enhance visibility and access during surgery. This step is crucial for minimizing bleeding and facilitating the subsequent surgical procedures, such as prostatectomy or other interventions. \\
% Leak Testing, etc & 2 & Leak testing involves filling the surgical site or reconstructed structure with a fluid (usually saline) to assess for any leaks or defects in the anastomosis or closure. This step is crucial to ensure the integrity of the surgical repair before finalizing the procedure, as it helps identify potential complications that could lead to postoperative issues. \\
\bottomrule
\end{tabular}
\vspace{-8pt}
\caption{\textbf{(3) Local task definitions used to provide clinical context alongside the procedure.} GPT\mbox{-}4o was prompted to produce concise, clinically oriented summaries for each procedure. These texts were encoded with the same surgery-pretrained video–language backbone used for the video stream (Sec.~\ref{subsec:clinical_context}).}
\label{tab:task_definitions_3}
\end{table*}

\begin{table*}[t]
\centering
\small
\setlength{\tabcolsep}{8pt}
\renewcommand{\arraystretch}{1.15}
\begin{tabular}{%
    >{\raggedright\arraybackslash}p{0.20\textwidth} 
    >{\raggedright\arraybackslash}p{0.05\textwidth} 
    >{\raggedright\arraybackslash}p{0.72\textwidth} 
}
\toprule
\textbf{Local Task} & \textbf{Count} & \textbf{Definition (GPT-4o-generated)} \\
\midrule
% Bladder Neck & 123 & The bladder neck is the region where the bladder connects to the urethra, and during surgical teaching, it is crucial to demonstrate the anatomy and function of this area, emphasizing its role in urinary continence and the potential complications that can arise from surgical manipulation, such as in prostatectomy procedures. Instruct trainees on identifying the bladder neck's landmarks and techniques for preserving its integrity during surgery to minimize postoperative complications. \\
% SV & 54 & In urology surgery, the teaching step "SV" refers to "Surgical Visualization," which emphasizes the importance of clear and effective visualization of the surgical field through proper positioning, retraction, and use of appropriate lighting and magnification techniques to enhance the surgeon's ability to identify anatomical structures and perform precise interventions. \\
% Posterior Plane & 6 & The posterior plane refers to the anatomical space located behind the bladder and prostate, which is critical for accessing the pelvic structures during urological surgeries. In teaching this step, emphasize the importance of identifying and carefully dissecting the posterior plane to avoid injury to surrounding nerves and vessels while facilitating access to the surgical site. \\
% Pedicle/NVB & 24 & The Pedicle/Nerve Vascular Bundle (NVB) step involves careful identification and preservation of the neurovascular structures during urological surgery, particularly in procedures like prostatectomy, to minimize the risk of nerve damage and maintain erectile function. Surgeons should be trained to meticulously dissect around these structures, using appropriate techniques to ensure their integrity while achieving the surgical goals. \\
% Apical Dissection & 10 & Apical dissection involves carefully separating the tissue at the apex of the prostate to access the surrounding structures while preserving critical neurovascular bundles. This step is crucial for minimizing complications and ensuring adequate oncological control during prostatectomy procedures. \\
% DVC & 7 & DVC, or "Dorsal Venous Complex," refers to the anatomical structure that is critical in urological surgeries, particularly during penile procedures. Teaching this step involves instructing trainees on the identification and management of the DVC to prevent excessive bleeding and ensure proper surgical technique during operations such as circumcision or penile reconstruction. \\
% Oblique Checks & 8 & Oblique checks involve assessing the orientation and positioning of the surgical instruments and anatomical structures during a urological procedure to ensure proper alignment and access. This step is crucial for minimizing complications and optimizing the surgical approach. \\
% VUA & 154 & Vesicourethral anastomosis (VUA) is the surgical step where the bladder is reconnected to the urethra after prostatectomy or bladder surgery, ensuring proper alignment and tension-free suturing to facilitate optimal healing and urinary function. This step typically involves careful dissection, identification of anatomical landmarks, and the use of absorbable sutures to secure the anastomosis. \\
% Adenoma Dissection & 115 & Adenoma dissection involves carefully identifying and separating the adenomatous tissue from surrounding structures using precise surgical techniques, ensuring minimal trauma to adjacent healthy tissue. This step is crucial for achieving complete resection while preserving functional anatomy and reducing the risk of complications. \\
% Lymph Node Dissection & 197 & Lymph node dissection involves the surgical removal of lymph nodes to assess for cancer spread, typically performed in conjunction with other procedures such as radical prostatectomy or cystectomy. The teaching step includes identifying the anatomical landmarks, ensuring proper technique to minimize complications, and understanding the implications of lymphatic drainage in urological malignancies. \\
% Dropping Bladder & 104 & Dropping the bladder involves carefully mobilizing the bladder from its anatomical attachments to the pelvic structures, ensuring that the surrounding tissues are preserved while providing adequate exposure for the surgical procedure. This step is crucial for accessing the underlying structures and minimizing the risk of injury during surgery. \\
% Endopelvic Fascia & 32 & The endopelvic fascia is a connective tissue layer that supports pelvic organs and is crucial in urological surgeries. During teaching, emphasize its anatomical significance, the importance of preserving it to maintain pelvic support, and techniques for identifying and dissecting it safely to avoid complications. \\
% Pedicles/NVB/Apical Dissection & 5 & During the pedicles, neurovascular bundles (NVB), and apical dissection step, the surgeon carefully identifies and preserves the neurovascular structures while mobilizing the prostate and surrounding tissues. This involves meticulous dissection to minimize damage to the nerves and blood vessels, ensuring optimal functional outcomes post-surgery. \\
% Bowel Mobilization & 131 & Bowel mobilization involves carefully dissecting and freeing the bowel from surrounding structures to create a clear surgical field, ensuring that the bowel can be safely retracted or manipulated without compromising its blood supply or function. This step is crucial for accessing the surgical site and minimizing the risk of postoperative complications. \\
% Dissection & 181 & Dissection involves carefully separating and isolating anatomical structures using surgical instruments, ensuring minimal trauma to surrounding tissues while providing clear access to the target area for further surgical intervention. This step requires a thorough understanding of anatomy and meticulous technique to avoid complications. \\
% Stapling Ureter & 1 & The teaching step for stapling the ureter involves carefully aligning the ureteral edges to ensure proper tension and orientation, followed by the application of a surgical stapler to create a secure and watertight anastomosis. It is crucial to assess the integrity of the staple line and ensure there are no obstructions or kinks in the ureter post-stapling. \\
% Bagging Specimen & 4 & Bagging the specimen involves carefully placing the excised tissue or organ into a sterile bag to prevent contamination and facilitate safe handling during transport to pathology. This step is crucial for maintaining specimen integrity and ensuring accurate diagnostic evaluation. \\
% Cystotomy & 17 & Cystotomy is the surgical procedure involving an incision into the bladder to access its interior, typically performed to remove bladder stones, tumors, or to facilitate other surgical interventions. During teaching, emphasize the importance of proper incision technique, maintaining hemostasis, and ensuring bladder integrity to prevent complications. \\
% Closing Bladder & 112 & Closing the bladder involves carefully suturing the bladder wall using absorbable sutures in a continuous or interrupted fashion, ensuring proper alignment of the tissue layers to prevent leakage and promote healing. It is essential to maintain hemostasis and avoid tension on the sutures to minimize complications. \\
% Hemostasis/Bladder Neck & 1 & In the hemostasis step at the bladder neck, the surgeon meticulously identifies and controls any bleeding vessels using techniques such as cauterization or ligation, ensuring a clear surgical field and minimizing the risk of postoperative complications. This step is crucial for maintaining hemostatic balance and facilitating a safe and effective surgical procedure. \\
% DVC, Hemostasis, Rocco Stitch & 5 & DVC (Dorsal Venous Complex) management involves careful identification and control of the dorsal venous complex to minimize bleeding during prostatectomy. Hemostasis is achieved by meticulously ligating or cauterizing blood vessels to prevent excessive blood loss, while the Rocco stitch is a surgical technique used to reinforce the posterior urethral support by suturing the bladder neck to the pelvic floor, enhancing continence postoperatively. \\
% DVC, Hemostasis & 1 & DVC (Dorsal Venous Complex) hemostasis involves identifying and controlling the dorsal venous complex during urological procedures, typically by clamping, ligating, or cauterizing the vessels to prevent excessive bleeding. This step is crucial for maintaining a clear surgical field and ensuring patient safety throughout the operation. \\
% Bladder Neck (Trigonization?) & 7 & Bladder neck trigonization involves the surgical technique of reshaping or reconstructing the bladder neck to improve urinary function, often performed during procedures for conditions like bladder outlet obstruction or incontinence. The teaching step emphasizes the importance of identifying anatomical landmarks, ensuring proper tension on the bladder neck, and achieving a secure closure to maintain urinary continence postoperatively. \\
% Tumor Dissection & 1 & Tumor dissection involves carefully separating the tumor from surrounding tissues and structures while preserving critical anatomical landmarks and minimizing damage to adjacent organs. This step requires meticulous technique to ensure complete tumor removal and to reduce the risk of recurrence or complications. \\
% Suturing Kidney & 1 & When suturing the kidney, begin by selecting an appropriate suture material and needle, then carefully approximate the renal tissue edges using a continuous or interrupted technique, ensuring to avoid excessive tension to preserve blood supply and function. Finally, secure the sutures with adequate knots, ensuring hemostasis and proper alignment of the renal parenchyma. \\
% Peritoneal Flap and Mesh Pocket Dissection & 11 & Peritoneal flap and mesh pocket dissection involves carefully mobilizing the peritoneum to create a flap that can be used to cover a surgical site, while simultaneously dissecting a pocket for the placement of mesh. This step requires meticulous attention to avoid injury to surrounding structures and ensure adequate space for secure mesh placement, promoting optimal healing and minimizing complications. \\
% Anchoring of Mesh & 4 & Anchoring of mesh involves securely attaching the surgical mesh to the surrounding tissue to provide support and prevent migration, typically using sutures or fixation devices. This step is crucial for ensuring the stability and effectiveness of the mesh in reinforcing the pelvic floor or repairing hernias. \\
% Closing Peritoneum & 12 & Closing the peritoneum involves carefully approximating the edges of the peritoneal layer using absorbable sutures, ensuring that the tissue is aligned properly to promote healing and minimize the risk of adhesions. It is important to maintain a tension-free closure while avoiding excessive manipulation of surrounding structures. \\
% Bladder Closure & 7 & Bladder closure involves meticulously suturing the bladder wall to ensure a secure and watertight seal, typically using absorbable sutures in a continuous or interrupted fashion, while carefully avoiding tension on the tissue to promote optimal healing and prevent complications such as leakage or stricture. It is essential to assess the integrity of the closure before concluding the procedure, often by performing a saline test to check for any leaks. \\
SVs & 50 & SVs, or surgical videos, are utilized as a teaching step to provide visual demonstrations of surgical techniques and procedures. They serve as an educational tool to enhance understanding of anatomy, instrumentation, and surgical maneuvers, allowing trainees to visualize complex steps before performing them in the operating room. \\
SV/Vas & 20 & The SV/Vas teaching step involves the identification and dissection of the seminal vesicles (SV) and vas deferens (Vas) during urological surgery, ensuring careful preservation of surrounding structures while facilitating access for procedures such as vasectomy or prostatectomy. This step emphasizes the importance of anatomical landmarks and the technique of blunt and sharp dissection to minimize complications. \\
Bladder Neck (Suture) & 4 & The bladder neck suture step involves placing sutures at the bladder neck to provide support and maintain proper anatomical alignment, which is crucial for preventing postoperative complications such as urinary incontinence. This step requires careful technique to ensure the sutures are secure yet not overly tight, allowing for normal bladder function. \\
NVB & 7 & NVB, or Neurovascular Bundle, refers to the critical anatomical structures that include nerves and blood vessels surrounding the prostate. In surgical teaching, it is essential to identify and preserve the NVB during prostatectomy to maintain erectile function and minimize complications, emphasizing careful dissection and awareness of anatomical landmarks. \\
Pexy & 7 & Pexy refers to the surgical technique of anchoring or securing an organ or tissue to another structure, often used in procedures like cystopexy or nephropexy to stabilize the bladder or kidney, respectively. In teaching this step, emphasize the importance of proper anatomical identification, tension management, and the choice of suturing technique to ensure effective stabilization while minimizing complications. \\
Defatting Prostate & 2 & Defatting the prostate involves carefully removing excess adipose tissue surrounding the prostate gland to enhance visibility and access during surgery. This step is crucial for minimizing bleeding and facilitating the subsequent surgical procedures, such as prostatectomy or other interventions. \\
Leak Testing, etc & 2 & Leak testing involves filling the surgical site or reconstructed structure with a fluid (usually saline) to assess for any leaks or defects in the anastomosis or closure. This step is crucial to ensure the integrity of the surgical repair before finalizing the procedure, as it helps identify potential complications that could lead to postoperative issues. \\
\bottomrule
\end{tabular}
\vspace{-8pt}
\caption{\textbf{(4) Local task definitions used to provide clinical context alongside the procedure.} GPT\mbox{-}4o was prompted to produce concise, clinically oriented summaries for each procedure. These texts were encoded with the same surgery-pretrained video–language backbone used for the video stream (Sec.~\ref{subsec:clinical_context}).}
\label{tab:task_definitions_4}
\end{table*}

%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% ONTOLOGY BEGINS %%%%
%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%
%%% SECTION 7 %%%
%%%%%%%%%%%%%%%%%

\section{Ontology: Mapping Cluster Tags to Individual Mentions}
\label{app:ontology_tag_to_mention}

\subsection{Instrument Ontology: Cluster--to--Mention Mapping}
\label{app:instrument_mapping}
Table~\ref{tab:instrument_cluster_mapping} lists the mapping between \emph{instrument} cluster tags and the raw surface forms (with counts) mined from trainer$\rightarrow$trainee feedback. These mappings were used to normalize lexical variation during ontology construction (Sec.~\ref{sec:ontology_from_raw_feedback}).

\begin{table*}[t]
\small
\centering
\setlength{\tabcolsep}{6pt}
\renewcommand{\arraystretch}{1.15}
\begin{tabular}{%
  >{\raggedright\arraybackslash}p{0.22\textwidth}%
  >{\raggedright\arraybackslash}p{0.74\textwidth}%
}
\toprule
\textbf{Instrument cluster tag} & \textbf{Individual mentions (count)} \\
\midrule
\texttt{energy\_device} &
\texttt{electrocautery (59); hook (6); energy device (3); bovie (2); coagulation tool (1); clip (1); coagulator (1); monopolar (1); bipolar (1); vessel sealer (1); bovy (1); buzz (1); energy devices (1)} \\
\addlinespace[2pt]
\texttt{fourth\_arm} &
\texttt{fourth arm (32); 4th arm (30); stitch (2); retractor (1); scissors (1)} \\
\addlinespace[2pt]
\texttt{left\_hand} &
\texttt{left hand (86); left arm (2); right hand (2); scissors (2); 4th arm (1); fourth arm (1); left hand instrument (1)} \\
\addlinespace[2pt]
\texttt{needle} &
\texttt{needle (33); needles (3); balloon (1); suture (1)} \\
\addlinespace[2pt]
\texttt{stitch} &
\texttt{stitch (29); stitches (9); chromic stitch (1); foley (1)} \\
\addlinespace[2pt]
\texttt{suture\_material} &
\texttt{suture (18); sutures (5); vicryl (1); 3-0 suture (1); vicyl stitch (1)} \\
\bottomrule
\end{tabular}
\caption{\textbf{Instrument cluster tags and their constituent mentions.} Counts in parentheses reflect frequency in the raw feedback corpus; items are shown verbatim (including capitalization and spelling variants).}
\label{tab:instrument_cluster_mapping}
\end{table*}


\subsection{Tissue Ontology: Cluster--to--Mention Mapping}
\label{app:tissue_mapping}
Table~\ref{tab:tissue_cluster_mapping} lists the mapping between \emph{tissue} cluster tags and the raw surface forms (with counts) mined from trainer$\rightarrow$trainee feedback. These mappings were used to normalize lexical variation during ontology construction (Sec.~\ref{sec:ontology_from_raw_feedback}).

\begin{table*}[t]
\small
\centering
\setlength{\tabcolsep}{6pt}
\renewcommand{\arraystretch}{1.15}
\begin{tabular}{%
  >{\raggedright\arraybackslash}p{0.22\textwidth}%
  >{\raggedright\arraybackslash}p{0.74\textwidth}%
}
\toprule
\textbf{Tissue cluster tag} & \textbf{Individual mentions (count)} \\
\midrule
\texttt{adrenal\_kidney\_region} &
\texttt{kidney (10); liver (5); psoas (5); adrenal (2); lateral edge of adrenal (2); cyst (2); adrenal vessels (1); lower pole (1); fascia of psoas (1); psoas sheets (1); pancreas (1); adrenal gland (1); pelvic brim (1); fat plane (1); adrenal area (1); tendon (1); spleen (1)} \\
\addlinespace[2pt]
\texttt{bladder} &
\texttt{bladder (37); bladder neck (13); posterior bladder neck (3); anterior bladder neck (2); prostate (2); bladder fibers (1); central suture (1); vessels (1); abdominal fat (1); needle catheter (1)} \\
\addlinespace[2pt]
\texttt{general\_vasculature} &
\texttt{vessel (27); vessels (10); veins (3); aorta (3); arteries (2); vein (2); pedicles (1); blood vessel (1); lateral structure (1); arterial pumper (1); blood clot (1); epigastric vessel (1); tissue (1); nerves (1)} \\
\addlinespace[2pt]
\texttt{gi\_tract} &
\texttt{mucosa (22); bowel (6); rectum (4); diverticuli (1); mucosal edge (1); colon (1); rectal integrity (1); inner mucosa (1); bowel wall (1); ileostomy (1); ileum (1)} \\
\addlinespace[2pt]
\texttt{major\_veins} &
\texttt{vein (55); veins (4); tissue (2); lumbar vein (1); cava (1); puboprostatic ligaments (1); external iliac vein (1); inferior vena cava (1)} \\
\addlinespace[2pt]
\texttt{muscle\_capsule} &
\texttt{muscle (8); capsule (6); detrusor fibers (3); capsule fibers (2); muscle fiber (1); tendon (1); detrusor muscle (1); muscle fibers (1); rectourethralis muscle (1); diaphragm (1); detrusor (1)} \\
\addlinespace[2pt]
\texttt{prostate\_tissue} &
\texttt{prostate (67); adenoma (11); prostate contour (6); tumor (2); median lobe (2); fat (1); apex (1); peripheral zone (1); vessel (1); tissue (1); small prostate (1); detrusor fibers (1)} \\
\addlinespace[2pt]
\texttt{seminal\_vesicle\_vas} &
\texttt{Seminal Vesicles (18); vas deferens (15); tissue (3); Vas deferens (2); septum (1); VAS (1); spermatic cord (1); medial aspect (1); vessels (1); vesicles (1); medial surface (1)} \\
\addlinespace[2pt]
\texttt{ureter} &
\texttt{ureter (38); gondal (1); gonadal (1); colon (1); fat (1); urether (1)} \\
\addlinespace[2pt]
\texttt{urethra} &
\texttt{urethra (28); bladder (4); sphincter (3); lateral structure (1); posterior plane (1); tissue around urethra (1); periurethral tissue (1); bladder neck (1); urethra edge (1); posterior structure (1); apex (1)} \\
\bottomrule
\end{tabular}
\caption{\textbf{Tissue cluster tags and their constituent mentions.} Counts in parentheses reflect frequency in the raw feedback corpus; items are shown verbatim (including capitalization and spelling variants).}
\label{tab:tissue_cluster_mapping}
\end{table*}




\subsection{Action Ontology: Cluster--to--Mention Mapping}
\label{app:action_mapping}
Tables~\ref{tab:action_cluster_mapping_p1} and \ref{tab:action_cluster_mapping_p2} list the mapping between \emph{action} cluster tags and the raw surface forms (with counts) mined from trainer$\rightarrow$trainee feedback. These mappings were used to normalize lexical variation during ontology construction (Sec.~\ref{sec:ontology_from_raw_feedback}).

\begin{table*}[t]
\small
\centering
\setlength{\tabcolsep}{6pt}
\renewcommand{\arraystretch}{1.15}
\begin{tabular}{%
  >{\raggedright\arraybackslash}p{0.19\textwidth}%
  >{\raggedright\arraybackslash}p{0.77\textwidth}%
}
\toprule
\textbf{Action cluster tag} & \textbf{Individual mentions (count)} \\
\midrule
\texttt{adjust} &
\texttt{get right (3); slow down (2); go slow (2); narrow down (2); match up (1); take (1); increase (1); go slower (1); go (1); ease (1); use less (1); give yourself enough length (1); spend a little extra time (1); narrow it down (1); set up (1); be slower (1); see (1); T it (1)} \\
\addlinespace[2pt]
\texttt{adjust\_direction} &
\texttt{go lateral (4); be more midline (1); Aim back up (1); err on the lateral sides (1); come from the lateral side (1); go obliquely (1); avoid (1); come obliquely (1); come from the sides (1); go cephalad more (1); come across (1); go to the other side (1); go more anterior (1); proceed lateral (1); "go to other side" (1); go anterior (1); get to midline (1); go medial (1); bring right (1); push medially (1); get to the medial (1); stay medial (1); perpendicular (1); start laterally (1); get out laterally (1); march medially (1); cock (1); "go to the other side" (1); extend right (1); come proximal (1); come from the other side (1); march up laterally (1); come to the other side (1); go in (1); work towards midline (1); up (1)} \\
\addlinespace[2pt]
\texttt{apply\_traction} &
\texttt{grab (9); don't pull (3); pull down (3); pull (3); pull back (2); hold (2); take (2); Press (2); stop (2); pull up (2); press (2); get better (1); pull with two hands (1); go (1); pull through (1); pull towards you (1); put (1); take out (1); regrab (1); bring (1); keep pulling down (1); pick up (1); press up (1); drop (1)} \\
\addlinespace[2pt]
\texttt{coagulate} &
\texttt{buzz (56); sweep (2); Buzz (2); don't buzz blindly (1); be patient (1); burn (1); coag (1); buzz on that crease (1); give a little buzz (1); bovie (1); wait (1); buzz directly (1); start buzzing (1); buzz off (1); buzz little (1); do buzzing (1); lift (1); buzz it (1); buzz right above (1); identify (1); pre buzz (1); keep buzzing (1); Buzz higher (1); buzz slowly (1); get around (1); look (1); take (1); go down (1)} \\
\addlinespace[2pt]
\texttt{continue\_action} &
\texttt{give (7); do (5); try (3); use (3); exhaust (1); create more (1); do more (1); use it (1); Do (1); do again (1); practice (1); do one (1); try doing (1); Be proactive (1)} \\
\addlinespace[2pt]
\texttt{control\_depth} &
\texttt{go down (4); go higher (3); come down (2); go deeper (2); keep going down (2); stay up (2); get up (2); take higher (2); try to get (1); come above (1); go lower (1); put one below first (1); stay low (1); work (1); go further down (1); stay above (1); start higher (1); go below (1); get below (1); take (1); go down more (1); go above (1); go right below (1); get lower (1); higher up (1); don't go deep (1); take lower (1); get deeper (1); keep it low (1); stay down (1); get down (1); get under (1); get underneath (1); go deep (1)} \\
\addlinespace[2pt]
\texttt{cut} &
\texttt{cut (15); cut down (3); cold cut (2); do one thing (1); cut just above (1); slice (1); suture cut (1); cut carefully (1); keep cutting (1); start cutting (1); cut through (1)} \\
\addlinespace[2pt]
\texttt{dissect} &
\texttt{get off (7); deliver (2); free up (2); take out (2); take away (1); define (1); bloc it (1); stay sharp (1); go down (1); scrape (1); bag (1); dont scrape (1); get more out (1); get off first (1)} \\
\addlinespace[2pt]
\texttt{ensure\_safety} &
\texttt{be careful (24); rip (5); be gentle (3); don't cut (3); rip carefully (2); be aware (1); dont rip (1); get first (1); err (1); DONT rip (1); rip out (1); spare (1); hit (1); dont be aggressive (1); come right (1); see (1); watch out (1); vigilant (1); rip off (1)} \\
\bottomrule
\end{tabular}
\caption{\textbf{Action cluster tags and their constituent mentions (part 1).} Counts in parentheses reflect frequency in the raw feedback corpus; items are shown verbatim (including capitalization and contractions).}
\label{tab:action_cluster_mapping_p1}
\end{table*}

\begin{table*}[t]
\small
\centering
\setlength{\tabcolsep}{6pt}
\renewcommand{\arraystretch}{1.15}
\begin{tabular}{%
  >{\raggedright\arraybackslash}p{0.24\textwidth}%
  >{\raggedright\arraybackslash}p{0.72\textwidth}%
}
\toprule
\textbf{Action cluster tag} & \textbf{Individual mentions (count)} \\
\midrule
\addlinespace[2pt]
\texttt{grasp} &
\texttt{grab (51); take (44); regrab (5); take it (4); hold (2); hang on (2); take less (2); don't grab (2); look up (2); start (1); take first (1); push up (1); take one more (1); let go (1); grab lower (1); grab over (1); let it fall (1); "Take" (1); get more tissue (1); grab with left hand (1); grab less (1)} \\
\addlinespace[2pt]
\texttt{inspect} &
\texttt{see (10); watch (6); do (2); look (2); reduce (1); see below (1); see posterior plane (1); extract (1); look down (1); grab (1); look higher (1); take (1); watch videos (1); look back (1); do one side (1); see more structures (1); UA back (1); make sure (1)} \\
\addlinespace[2pt]
\texttt{navigate\_space} &
\texttt{come (5); travel more (4); come back (3); get out (2); back up (2); come out (2); bring (2); go back (2); travel (2); travel a little bit (2); come back a little bit (1); inch a little bit (1); get right on (1); come in a little bit (1); travel here (1); come back a little more (1); proceed up (1); come more (1); don't travel so much (1); move (1); Rock out a little bit (1); travel a little bit more (1); come up (1); go more (1); bring back up (1); go back down (1); bring in (1); enter back (1); travel less (1); rock back (1); move back (1); come back down (1); get in (1); get away (1); get the tip out (1); get on the plane (1); go in (1)} \\
\addlinespace[2pt]
\texttt{open} &
\texttt{open (45); open up (8); open more (3); open up a little bit more (2); open up wide (1); show (1); open completely (1); Get tips in (1); make (1); forget (1); keep going (1); let go (1); open out a little bit more (1); stop (1); open laterally (1); open spaces (1); open wide (1); come out (1); extend (1)} \\
\addlinespace[2pt]
\texttt{perform\_sweeping\_maneuvers} &
\texttt{sweep (23); sweep down (5); sweep off (3); don't sweep (2); sweep up (2); sweep towards you (2); swipe (2); sweep back (2); preserve (1); swipe up (1); Sweep it down (1); sweep further (1); gently sweep (1); sweep away (1); stay (1); sweep more (1); drive (1); sweep towards (1); sweep again (1); spread transversely (1); lateral sweep (1); be gentle (1); bluntly sweep off (1); do shorter sweeps (1); gently sweep back (1); sweep shorter (1); start from top down (1); sweep laterally (1); use more energy (1)} \\
\addlinespace[2pt]
\texttt{release\_instrument} &
\texttt{drop (11); leave (6); leave it (2); drop down (1); leave it be (1); leave a little bit (1); leave alone (1); leave it alone (1); Release a little bit (1); leave a little more (1); finish dropping (1); start (1); get in (1)} \\
\addlinespace[2pt]
\texttt{rotate} &
\texttt{rotate (6); reverse (1); Rotate (1); do (1)} \\
\addlinespace[2pt]
\texttt{spread} &
\texttt{separate (4); widen (3); make it wide (1); extend distally (1); skinny down (1); thin out (1); don't go too wide (1); open (1); open up (1); go right (1); go wide (1); spread (1); put (1); let go (1); don't go wide (1)} \\
\addlinespace[2pt]
\texttt{stop} &
\texttt{stop (48); stop short (1); Stop (1)} \\
\addlinespace[2pt]
\texttt{suture} &
\texttt{throw (5); sew (1); don't pull (1); loop up (1); take stitch (1); bigger loop (1); throw sutures (1); take (1); loop (1)} \\
\addlinespace[2pt]
\texttt{turn} &
\texttt{turn (19); flip (5); flip up (2); U it back (1); Turn more (1); curl (1); go in (1); round (1); Grab (1); turn more (1); try turning (1); turn towards (1); turn up (1); learn (1); curve (1); turn out (1)} \\

\bottomrule
\end{tabular}
\caption{\textbf{Action cluster tags and their constituent mentions (part 2).} Counts in parentheses reflect frequency in the raw feedback corpus; items are shown verbatim (including capitalization and contractions).}
\label{tab:action_cluster_mapping_p2}
\end{table*}

\begin{figure*}[t]
  \centering
  \includegraphics[width=\textwidth,
                   height=0.40\textheight,
                   keepaspectratio]{figures/IAT_class_counts_with_thresholds.png}
  \vspace{-6pt}
  \caption{\textbf{IAT class frequency and elbow thresholds.} Class counts for instruments, actions, and tissues (sorted by frequency). Dashed lines indicate elbow‐derived cutoffs (29/9/24); legend also reports the number of feedback lines with \texttt{NONE} for that triplet component.}
  \label{fig:iat_class_counts_with_thresholds}
  \vspace{-6pt}
\end{figure*}


\section{Training and Implementation Details}
\label{apd:training_details}

This section provides detailed information on the training procedures and model configurations used in our experiments.

\parahead{Task 1: Video $\rightarrow$ IAT Prediction.}
The models for this task are trained and evaluated using a 5-fold stratified cross-validation scheme. Each of the three heads (Instrument, Action, Tissue) is trained as an independent multi-class classifier.
\begin{itemize}[leftmargin=*, itemsep=-0.3em, topsep=2pt]
    \item \textbf{Context-Only Models:} For baselines that fuse video and clinical context embeddings without temporal tracking, we use an `MLPClassifier` from Scikit-learn. The network consists of three hidden layers with (64, 32, 16) units respectively, using a ReLU activation function and the Adam optimizer, trained for a maximum of 1000 iterations.
   \item \textbf{Temporal Tracking Model (Ours):} Our full model uses a two-stage hybrid approach to incorporate motion. \textbf{Stage 1 (Learning Motion Representation):} We first train a PyTorch fusion model containing an LSTM component. This initial end-to-end training teaches the LSTM to extract task-relevant features from instrument coordinate sequences. The model's core is a 10-layer LSTM with 32 hidden units, and it is trained for 20 epochs (Adam optimizer, LR $1 \times 10^{-3}$, batch size 8). \textbf{Stage 2 (Final Classification):} After Stage 1, the trained LSTM component is used as a fixed feature extractor to generate a motion embedding for each video clip. These motion embeddings are then concatenated with the video and clinical context embeddings. A Scikit-learn `MLPClassifier` is trained on this final combined feature vector to perform the classification. This MLP's architecture is identical to our context-only baselines: three hidden layers (64, 32, 16) with ReLU activation, trained for up to 1000 iterations.
\end{itemize}

\parahead{Task 2: Feedback Generation.} All fine-tuned models are trained for three full passes over the training data unless otherwise specified.
\begin{itemize}[leftmargin=*, itemsep=-0.3em, topsep=2pt]
    \item \textbf{VQA LLaMA (11B):} This baseline uses a pre-trained `unsloth/llama-3.2-11b-vision-instruct-bnb-4bit` model. We frame the task as visual question answering, prompting the model with the procedure, task, and a single video frame to generate the corresponding feedback. The model is fine-tuned using Low-Rank Adaptation (LoRA, rank=16) on all self-attention projection layers (`q\_proj`, `k\_proj`, `v\_proj`, `o\_proj`, etc.). From each 10-second video clip, we create 10 separate training instances by uniformly sampling 10 frames and pairing each frame individually with the ground-truth feedback. Training is performed using an 8-bit AdamW optimizer with a learning rate of $2 \times 10^{-4}$ and a linear scheduler.
    \item \textbf{SurgVLP Gen:} This baseline is a video captioning model composed of a SurgVLP encoder (ResNet-50 backbone) and a standard GPT-2 decoder. A trainable two-layer mapping network translates the video embedding into a soft prompt (prefix length of 8 tokens) for the decoder. The video embedding is derived by mean-pooling the features of 3 uniformly sampled frames from each clip. The entire model—encoder, mapper, and decoder—is fine-tuned end-to-end for 30 epochs using an AdamW optimizer with distinct learning rates for the mapper ($3 \times 10^{-4}$) and the language model ($5 \times 10^{-6}$), with a cosine learning rate schedule.
\end{itemize}

\begin{table*}[ht!]
\small
\centering
\begin{tabular}{llccccccccc}
\toprule
\textbf{Base Model} & \textbf{Context} & 
\multicolumn{3}{c}{\textbf{Instrument}} & 
\multicolumn{3}{c}{\textbf{Action}} & 
\multicolumn{3}{c}{\textbf{Tissue}} \\
\cmidrule(lr){3-5} \cmidrule(lr){6-8} \cmidrule(lr){9-11}
& & F1 & Precision & Recall & F1 & Precision & Recall & F1 & Precision & Recall \\
\midrule
\multirow{4}{*}{SurgVLP} 
& Vision & $0.28_{\pm0.02}$ & $0.29_{\pm0.03}$ & $0.29_{\pm0.02}$ & $0.09_{\pm0.01}$ & $0.09_{\pm0.01}$ & $0.09_{\pm0.01}$ & $0.30_{\pm0.01}$ & $0.34_{\pm0.03}$ & $0.29_{\pm0.01}$ \\
& + Procedure & $0.29_{\pm0.02}$ & $0.31_{\pm0.03}$ & $0.31_{\pm0.02}$ & $0.10_{\pm0.02}$ & $0.11_{\pm0.02}$ & $0.10_{\pm0.02}$ & $0.29_{\pm0.03}$ & $0.32_{\pm0.04}$ & $0.29_{\pm0.03}$ \\
& + Task & $0.31_{\pm0.05}$ & $0.32_{\pm0.05}$ & $0.31_{\pm0.04}$ & {\boldmath $0.12_{\pm0.03}$} & {\boldmath $0.13_{\pm0.04}$} & {\boldmath $0.12_{\pm0.03}$} & $0.33_{\pm0.04}$ & {\boldmath $0.35_{\pm0.04}$} & $0.33_{\pm0.04}$ \\
& + Temporal Tracking (our) & {\boldmath $0.33_{\pm0.04}$} & {\boldmath $0.33_{\pm0.04}$} & {\boldmath $0.35_{\pm0.05}$} & $0.10_{\pm0.02}$ & $0.11_{\pm0.02}$ & $0.11_{\pm0.02}$ & {\boldmath $0.34_{\pm0.02}$} & {\boldmath $0.35_{\pm0.01}$} & {\boldmath $0.35_{\pm0.02}$} \\
\midrule
\multirow{4}{*}{HecVL} 
& Vision & $0.28_{\pm0.05}$ & $0.35_{\pm0.06}$ & $0.35_{\pm0.05}$ & $0.10_{\pm0.01}$ & $0.11_{\pm0.02}$ & $0.11_{\pm0.02}$ & $0.30_{\pm0.04}$ & $0.32_{\pm0.05}$ & $0.31_{\pm0.04}$ \\
& + Procedure & $0.29_{\pm0.04}$ & $0.30_{\pm0.05}$ & $0.30_{\pm0.05}$ & $0.11_{\pm0.01}$ & $0.11_{\pm0.01}$ & {\boldmath $0.12_{\pm0.01}$} & $0.32_{\pm0.03}$ & $0.34_{\pm0.03}$ & $0.32_{\pm0.02}$ \\
& + Task & $0.33_{\pm0.06}$ & $0.33_{\pm0.07}$ & $0.34_{\pm0.07}$ & $0.10_{\pm0.02}$ & $0.10_{\pm0.02}$ & $0.11_{\pm0.02}$ & $0.32_{\pm0.04}$ & $0.34_{\pm0.04}$ & $0.33_{\pm0.04}$ \\
& + Temporal Tracking (our) & {\boldmath $0.38_{\pm0.07}$} & {\boldmath $0.39_{\pm0.07}$} & {\boldmath $0.39_{\pm0.07}$} & {\boldmath $0.12_{\pm0.01}$} & {\boldmath $0.12_{\pm0.02}$} & {\boldmath $0.12_{\pm0.01}$} & {\boldmath $0.36_{\pm0.04}$} & {\boldmath $0.38_{\pm0.04}$} & {\boldmath $0.36_{\pm0.03}$} \\
\midrule
\multirow{4}{*}{PeskaVLP} 
& Vision & $0.32_{\pm0.03}$ & $0.33_{\pm0.06}$ & $0.32_{\pm0.03}$ & $0.10_{\pm0.03}$ & $0.10_{\pm0.04}$ & $0.10_{\pm0.03}$ & $0.32_{\pm0.04}$ & $0.32_{\pm0.04}$ & $0.32_{\pm0.04}$ \\
& + Procedure & $0.30_{\pm0.05}$ & $0.30_{\pm0.05}$ & $0.29_{\pm0.05}$ & $0.10_{\pm0.02}$ & $0.09_{\pm0.02}$ & $0.10_{\pm0.02}$ & $0.30_{\pm0.04}$ & $0.32_{\pm0.04}$ & $0.30_{\pm0.04}$ \\
& + Task & $0.34_{\pm0.04}$ & $0.37_{\pm0.04}$ & $0.34_{\pm0.05}$ & $0.11_{\pm0.02}$ & $0.12_{\pm0.02}$ & $0.11_{\pm0.02}$ & $0.33_{\pm0.04}$ & $0.35_{\pm0.04}$ & $0.33_{\pm0.04}$ \\
& + Temporal Tracking (our) & {\boldmath $0.36_{\pm0.03}$} & {\boldmath $0.39_{\pm0.05}$} & {\boldmath $0.37_{\pm0.04}$} & {\boldmath $0.12_{\pm0.01}$} & {\boldmath $0.13_{\pm0.01}$} & {\boldmath $0.13_{\pm0.02}$} & {\boldmath $0.39_{\pm0.03}$} & {\boldmath $0.41_{\pm0.04}$} & {\boldmath $0.40_{\pm0.03}$} \\
\bottomrule
\end{tabular}
\end{table*}

\begin{table*}[ht!]
\small
\centering
\begin{tabular}{llcccccc}
\toprule
\textbf{Base Model} & \textbf{Context} & 
\multicolumn{2}{c}{\textbf{Instrument}} & 
\multicolumn{2}{c}{\textbf{Action}} & 
\multicolumn{2}{c}{\textbf{Tissue}} \\
\cmidrule(lr){3-4} \cmidrule(lr){5-6} \cmidrule(lr){7-8}
& & Precision & Recall & Precision & Recall & Precision & Recall \\
\midrule
\multirow{4}{*}{SurgVLP} 
& Vision & $0.29_{\pm0.03}$ & $0.29_{\pm0.02}$ & $0.09_{\pm0.01}$ & $0.09_{\pm0.01}$ & $0.34_{\pm0.03}$ & $0.29_{\pm0.01}$ \\
& + Procedure & $0.31_{\pm0.03}$ & $0.31_{\pm0.02}$ & $0.11_{\pm0.02}$ & $0.10_{\pm0.02}$ & $0.32_{\pm0.04}$ & $0.29_{\pm0.03}$ \\
& + Task & $0.32_{\pm0.05}$ & $0.31_{\pm0.04}$ & {\boldmath $0.13_{\pm0.04}$} & {\boldmath $0.12_{\pm0.03}$} & {\boldmath $0.35_{\pm0.04}$} & $0.33_{\pm0.04}$ \\
& + Temporal Tracking (our) & {\boldmath $0.33_{\pm0.04}$} & {\boldmath $0.35_{\pm0.05}$} & $0.11_{\pm0.02}$ & $0.11_{\pm0.02}$ & {\boldmath $0.35_{\pm0.01}$} & {\boldmath $0.35_{\pm0.02}$} \\
\midrule
\multirow{4}{*}{HecVL} 
& Vision & $0.35_{\pm0.06}$ & $0.35_{\pm0.05}$ & $0.11_{\pm0.02}$ & $0.11_{\pm0.02}$ & $0.32_{\pm0.05}$ & $0.31_{\pm0.04}$ \\
& + Procedure & $0.30_{\pm0.05}$ & $0.30_{\pm0.05}$ & $0.11_{\pm0.01}$ & {\boldmath $0.12_{\pm0.01}$} & $0.34_{\pm0.03}$ & $0.32_{\pm0.02}$ \\
& + Task & $0.33_{\pm0.07}$ & $0.34_{\pm0.07}$ & $0.10_{\pm0.02}$ & $0.11_{\pm0.02}$ & $0.34_{\pm0.04}$ & $0.33_{\pm0.04}$ \\
& + Temporal Tracking (our) & {\boldmath $0.39_{\pm0.07}$} & {\boldmath $0.39_{\pm0.07}$} & {\boldmath $0.12_{\pm0.02}$} & {\boldmath $0.12_{\pm0.01}$} & {\boldmath $0.38_{\pm0.04}$} & {\boldmath $0.36_{\pm0.03}$} \\
\midrule
\multirow{4}{*}{PeskaVLP} 
& Vision & $0.33_{\pm0.06}$ & $0.32_{\pm0.03}$ & $0.10_{\pm0.04}$ & $0.10_{\pm0.03}$ & $0.32_{\pm0.04}$ & $0.32_{\pm0.04}$ \\
& + Procedure & $0.30_{\pm0.05}$ & $0.29_{\pm0.05}$ & $0.09_{\pm0.02}$ & $0.10_{\pm0.02}$ & $0.32_{\pm0.04}$ & $0.30_{\pm0.04}$ \\
& + Task & $0.37_{\pm0.04}$ & $0.34_{\pm0.05}$ & $0.12_{\pm0.02}$ & $0.11_{\pm0.02}$ & $0.35_{\pm0.04}$ & $0.33_{\pm0.04}$ \\
& + Temporal Tracking (our) & {\boldmath $0.39_{\pm0.05}$} & {\boldmath $0.37_{\pm0.04}$} & {\boldmath $0.13_{\pm0.01}$} & {\boldmath $0.13_{\pm0.02}$} & {\boldmath $0.41_{\pm0.04}$} & {\boldmath $0.40_{\pm0.03}$} \\
\bottomrule
\end{tabular}
\end{table*}

\begin{table*}[ht!]
\small
\centering
\begin{tabular}{llcccccc}
\toprule
\textbf{Base Model} & \textbf{Context} & 
\multicolumn{2}{c}{\textbf{Instrument}} & 
\multicolumn{2}{c}{\textbf{Action}} & 
\multicolumn{2}{c}{\textbf{Tissue}} \\
\cmidrule(lr){3-4} \cmidrule(lr){5-6} \cmidrule(lr){7-8}
& & F1 & Gain & F1 & Gain & F1 & Gain \\
\midrule
\multirow{4}{*}{SurgVLP} 
& Vision & $0.28_{\pm0.02}$ & - & $0.09_{\pm0.01}$ & - & $0.30_{\pm0.01}$ & - \\
& + Procedure & $0.29_{\pm0.02}$ & \uab{3.6\%} & $0.10_{\pm0.02}$ & \uab{11.1\%} & $0.29_{\pm0.03}$ & \dar{3.3\%} \\
& + Task & $0.31_{\pm0.05}$ & \uab{10.7\%} & {\boldmath $0.12_{\pm0.03}$} & \uab{33.3\%} & $0.33_{\pm0.04}$ & \uab{10.0\%} \\
& + Temporal Tracking (our) & {\boldmath $0.33_{\pm0.04}$} & \uab{17.9\%} & $0.10_{\pm0.02}$ & \uab{11.1\%} & {\boldmath $0.34_{\pm0.02}$} & \uab{13.3\%} \\
\midrule
\multirow{4}{*}{HecVL} 
& Vision & $0.28_{\pm0.05}$ & - & $0.10_{\pm0.01}$ & - & $0.30_{\pm0.04}$ & - \\
& + Procedure & $0.29_{\pm0.04}$ & \uab{3.6\%} & $0.11_{\pm0.01}$ & \uab{10.0\%} & $0.32_{\pm0.03}$ & \uab{6.7\%} \\
& + Task & $0.33_{\pm0.06}$ & \uab{17.9\%} & $0.10_{\pm0.02}$ & \dar{0.0\%} & $0.32_{\pm0.04}$ & \uab{6.7\%} \\
& + Temporal Tracking (our) & {\boldmath $0.38_{\pm0.07}$} & \uab{35.7\%} & {\boldmath $0.12_{\pm0.01}$} & \uab{20.0\%} & {\boldmath $0.36_{\pm0.04}$} & \uab{20.0\%} \\
\midrule
\multirow{4}{*}{PeskaVLP} 
& Vision & $0.32_{\pm0.03}$ & - & $0.10_{\pm0.03}$ & - & $0.32_{\pm0.04}$ & - \\
& + Procedure & $0.30_{\pm0.05}$ & \dar{6.3\%} & $0.10_{\pm0.02}$ & \dar{0.0\%} & $0.30_{\pm0.04}$ & \dar{6.3\%} \\
& + Task & $0.34_{\pm0.04}$ & \uab{6.3\%} & $0.11_{\pm0.02}$ & \uab{10.0\%} & $0.33_{\pm0.04}$ & \uab{3.1\%} \\
& + Temporal Tracking (our) & {\boldmath $0.36_{\pm0.03}$} & \uab{12.5\%} & {\boldmath $0.12_{\pm0.01}$} & \uab{20.0\%} & {\boldmath $0.39_{\pm0.03}$} & \uab{21.9\%} \\
\bottomrule
\end{tabular}
\end{table*}


% \section{First Appendix}\label{apd:first}

% This is the first appendix.

% \section{Second Appendix}\label{apd:second}

% This is the second appendix.

\end{document}
